/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/liquidjs@10.21.0/dist/liquid.browser.mjs
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class Token{constructor(e,t,i,s,r){this.kind=e,this.input=t,this.begin=i,this.end=s,this.file=r}getText(){return this.input.slice(this.begin,this.end)}getPosition(){let[e,t]=[1,1];for(let i=0;i<this.begin;i++)"\n"===this.input[i]?(e++,t=1):t++;return[e,t]}size(){return this.end-this.begin}}class Drop{liquidMethodMissing(e){}}const toString$1=Object.prototype.toString,toLowerCase=String.prototype.toLowerCase,hasOwnProperty=Object.hasOwnProperty;function isString(e){return"string"==typeof e}function isFunction(e){return"function"==typeof e}function isPromise(e){return e&&isFunction(e.then)}function isIterator(e){return e&&isFunction(e.next)&&isFunction(e.throw)&&isFunction(e.return)}function escapeRegex(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function stringify(e){return isString(e=toValue(e))?e:isNil(e)?"":isArray(e)?e.map((e=>stringify(e))).join(""):String(e)}function toEnumerable(e){return isArray(e=toValue(e))?e:isString(e)&&e.length>0?[e]:isIterable(e)?Array.from(e):isObject(e)?Object.keys(e).map((t=>[t,e[t]])):[]}function toArray(e){return isNil(e=toValue(e))?[]:isArray(e)?e:[e]}function toValue(e){return e instanceof Drop&&isFunction(e.valueOf)?e.valueOf():e}function toNumber(e){return e=Number(e),isNaN(e)?0:e}function isNumber(e){return"number"==typeof e}function toLiquid(e){return e&&isFunction(e.toLiquid)?toLiquid(e.toLiquid()):e}function isNil(e){return null==e}function isUndefined(e){return void 0===e}function isArray(e){return"[object Array]"===toString$1.call(e)}function isArrayLike(e){return e&&isNumber(e.length)}function isIterable(e){return isObject(e)&&Symbol.iterator in e}function forOwn(e,t){e=e||{};for(const i in e)if(hasOwnProperty.call(e,i)&&!1===t(e[i],i,e))break;return e}function last(e){return e[e.length-1]}function isObject(e){const t=typeof e;return null!==e&&("object"===t||"function"===t)}function range(e,t,i=1){const s=[];for(let r=e;r<t;r+=i)s.push(r);return s}function padStart(e,t,i=" "){return pad(e,t,i,((e,t)=>t+e))}function padEnd(e,t,i=" "){return pad(e,t,i,((e,t)=>e+t))}function pad(e,t,i,s){let r=t-(e=String(e)).length;for(;r-- >0;)e=s(e,i);return e}function identify(e){return e}function changeCase(e){return[...e].some((e=>e>="a"&&e<="z"))?e.toUpperCase():e.toLowerCase()}function ellipsis(e,t){return e.length>t?e.slice(0,t-3)+"...":e}function caseInsensitiveCompare(e,t){return null==e&&null==t?0:null==e?1:null==t||(e=toLowerCase.call(e))<(t=toLowerCase.call(t))?-1:e>t?1:0}function argumentsToValue(e){return function(...t){return e.call(this,...t.map(toValue))}}function escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function*strictUniq(e){const t=new Set;for(const i of e){const e=JSON.stringify(i);t.has(e)||(t.add(e),yield i)}}const TRAIT="__liquidClass__";class LiquidError extends Error{constructor(e,t){super("string"==typeof e?e:e.message),this.context="","string"!=typeof e&&Object.defineProperty(this,"originalError",{value:e,enumerable:!1}),Object.defineProperty(this,"token",{value:t,enumerable:!1}),Object.defineProperty(this,TRAIT,{value:"LiquidError",enumerable:!1})}update(){Object.defineProperty(this,"context",{value:mkContext(this.token),enumerable:!1}),this.message=mkMessage(this.message,this.token),this.stack=this.message+"\n"+this.context+"\n"+this.stack,this.originalError&&(this.stack+="\nFrom "+this.originalError.stack)}static is(e){return"LiquidError"===(null==e?void 0:e[TRAIT])}}class TokenizationError extends LiquidError{constructor(e,t){super(e,t),this.name="TokenizationError",super.update()}}class ParseError extends LiquidError{constructor(e,t){super(e,t),this.name="ParseError",this.message=e.message,super.update()}}class RenderError extends LiquidError{constructor(e,t){super(e,t.token),this.name="RenderError",this.message=e.message,super.update()}static is(e){return"RenderError"===e.name}}class LiquidErrors extends LiquidError{constructor(e){super(e[0],e[0].token),this.errors=e,this.name="LiquidErrors";const t=e.length>1?"s":"";this.message=`${e.length} error${t} found`,super.update()}static is(e){return"LiquidErrors"===e.name}}class UndefinedVariableError extends LiquidError{constructor(e,t){super(e,t),this.name="UndefinedVariableError",this.message=e.message,super.update()}}class InternalUndefinedVariableError extends Error{constructor(e){super(`undefined variable: ${e}`),this.name="InternalUndefinedVariableError",this.variableName=e}}class AssertionError extends Error{constructor(e){super(e),this.name="AssertionError",this.message=e+""}}function mkContext(e){const[t,i]=e.getPosition(),s=e.input.split("\n"),r=Math.max(t-2,1),n=Math.min(t+3,s.length);return range(r,n+1).map((e=>{let r=`${e===t?">> ":"   "}${padStart(String(e),String(n).length)}| `;const o=e===t?"\n"+padStart("^",i+r.length):"";return r+=s[e-1],r+=o,r})).join("\n")}function mkMessage(e,t){t.file&&(e+=`, file:${t.file}`);const[i,s]=t.getPosition();return e+=`, line:${i}, col:${s}`}const TYPES=[0,0,0,0,0,0,0,0,0,20,4,4,4,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,2,8,0,0,0,0,8,0,0,0,64,0,65,0,0,33,33,33,33,33,33,33,33,33,33,0,0,2,2,2,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],WORD=1,BLANK=4,QUOTE=8,INLINE_BLANK=16,NUMBER=32,SIGN=64,PUNCTUATION=128;function isWord(e){const t=e.charCodeAt(0);return t>=128?!TYPES[t]:!!(1&TYPES[t])}function assert(e,t){if(!e){const i="function"==typeof t?t():t||`expect ${e} to be true`;throw new AssertionError(i)}}function assertEmpty(e,t=`unexpected ${JSON.stringify(e)}`){assert(!e,t)}TYPES[160]=TYPES[5760]=TYPES[6158]=TYPES[8192]=TYPES[8193]=TYPES[8194]=TYPES[8195]=TYPES[8196]=TYPES[8197]=TYPES[8198]=TYPES[8199]=TYPES[8200]=TYPES[8201]=TYPES[8202]=TYPES[8232]=TYPES[8233]=TYPES[8239]=TYPES[8287]=TYPES[12288]=4,TYPES[8220]=TYPES[8221]=128;class NullDrop extends Drop{equals(e){return isNil(toValue(e))}gt(){return!1}geq(){return!1}lt(){return!1}leq(){return!1}valueOf(){return null}}class EmptyDrop extends Drop{equals(e){return!(e instanceof EmptyDrop)&&(isString(e=toValue(e))||isArray(e)?0===e.length:!!isObject(e)&&0===Object.keys(e).length)}gt(){return!1}geq(){return!1}lt(){return!1}leq(){return!1}valueOf(){return""}static is(e){return e instanceof EmptyDrop}}class BlankDrop extends EmptyDrop{equals(e){return!1===e||(!!isNil(toValue(e))||(isString(e)?/^\s*$/.test(e):super.equals(e)))}static is(e){return e instanceof BlankDrop}}class ForloopDrop extends Drop{constructor(e,t,i){super(),this.i=0,this.length=e,this.name=`${i}-${t}`}next(){this.i++}index0(){return this.i}index(){return this.i+1}first(){return 0===this.i}last(){return this.i===this.length-1}rindex(){return this.length-this.i}rindex0(){return this.length-this.i-1}valueOf(){return JSON.stringify(this)}}class BlockDrop extends Drop{constructor(e=()=>""){super(),this.superBlockRender=e}super(){return this.superBlockRender()}}function isComparable(e){return e&&isFunction(e.equals)&&isFunction(e.gt)&&isFunction(e.geq)&&isFunction(e.lt)&&isFunction(e.leq)}const nil=new NullDrop,literalValues={true:!0,false:!1,nil:nil,null:nil,empty:new EmptyDrop,blank:new BlankDrop};function createTrie(e){const t={};for(const[i,s]of Object.entries(e)){let e=t;for(let t=0;t<i.length;t++){const s=i[t];e[s]=e[s]||{},t===i.length-1&&isWord(i[t])&&(e[s].needBoundary=!0),e=e[s]}e.data=s,e.end=!0}return t}var __assign=function(){return __assign=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__assign.apply(this,arguments)};function __awaiter(e,t,i,s){return new(i||(i=Promise))((function(r,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function a(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((s=s.apply(e,t||[])).next())}))}function toPromise(e){return __awaiter(this,void 0,void 0,(function*(){if(!isIterator(e))return e;let t,i=!1,s="next";do{const r=e[s](t);i=r.done,t=r.value,s="next";try{isIterator(t)&&(t=toPromise(t)),isPromise(t)&&(t=yield t)}catch(e){s="throw",t=e}}while(!i);return t}))}function toValueSync(e){if(!isIterator(e))return e;let t,i=!1,s="next";do{const r=e[s](t);if(i=r.done,t=r.value,s="next",isIterator(t))try{t=toValueSync(t)}catch(e){s="throw",t=e}}while(!i);return t}const rFormat=/%([-_0^#:]+)?(\d+)?([EO])?(.)/;function daysInMonth(e){return[31,isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31]}function getDayOfYear(e){let t=0;for(let i=0;i<e.getMonth();++i)t+=daysInMonth(e)[i];return t+e.getDate()}function getWeekOfYear(e,t){const i=getDayOfYear(e)+(t-e.getDay()),s=7-new Date(e.getFullYear(),0,1).getDay()+t;return String(Math.floor((i-s)/7)+1)}function isLeapYear(e){const t=e.getFullYear();return!(3&t||!(t%100||t%400==0&&t))}function ordinal(e){const t=e.getDate();if([11,12,13].includes(t))return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function century(e){return parseInt(e.getFullYear().toString().substring(0,2),10)}const padWidths={d:2,e:2,H:2,I:2,j:3,k:2,l:2,L:3,m:2,M:2,S:2,U:2,W:2},padSpaceChars=new Set("aAbBceklpP");function getTimezoneOffset(e,t){const i=Math.abs(e.getTimezoneOffset()),s=Math.floor(i/60),r=i%60;return(e.getTimezoneOffset()>0?"-":"+")+padStart(s,2,"0")+(t.flags[":"]?":":"")+padStart(r,2,"0")}const formatCodes={a:e=>e.getShortWeekdayName(),A:e=>e.getLongWeekdayName(),b:e=>e.getShortMonthName(),B:e=>e.getLongMonthName(),c:e=>e.toLocaleString(),C:e=>century(e),d:e=>e.getDate(),e:e=>e.getDate(),H:e=>e.getHours(),I:e=>String(e.getHours()%12||12),j:e=>getDayOfYear(e),k:e=>e.getHours(),l:e=>String(e.getHours()%12||12),L:e=>e.getMilliseconds(),m:e=>e.getMonth()+1,M:e=>e.getMinutes(),N:(e,t)=>{const i=Number(t.width)||9;return padEnd(String(e.getMilliseconds()).slice(0,i),i,"0")},p:e=>e.getHours()<12?"AM":"PM",P:e=>e.getHours()<12?"am":"pm",q:e=>ordinal(e),s:e=>Math.round(e.getTime()/1e3),S:e=>e.getSeconds(),u:e=>e.getDay()||7,U:e=>getWeekOfYear(e,0),w:e=>e.getDay(),W:e=>getWeekOfYear(e,1),x:e=>e.toLocaleDateString(),X:e=>e.toLocaleTimeString(),y:e=>e.getFullYear().toString().slice(2,4),Y:e=>e.getFullYear(),z:getTimezoneOffset,Z:(e,t)=>e.getTimeZoneName()||getTimezoneOffset(e,t),t:()=>"\t",n:()=>"\n","%":()=>"%"};function strftime(e,t){let i,s="",r=t;for(;i=rFormat.exec(r);)s+=r.slice(0,i.index),r=r.slice(i.index+i[0].length),s+=format(e,i);return s+r}function format(e,t){const[i,s="",r,n,o]=t,a=formatCodes[o];if(!a)return i;const l={};for(const e of s)l[e]=!0;let c=String(a(e,{flags:l,width:r,modifier:n})),u=padSpaceChars.has(o)?" ":"0",h=r||padWidths[o]||0;return l["^"]?c=c.toUpperCase():l["#"]&&(c=changeCase(c)),l._?u=" ":l[0]&&(u="0"),l["-"]&&(h=0),padStart(c,h,u)}function getDateTimeFormat(){return"undefined"!=typeof Intl?Intl.DateTimeFormat:void 0}formatCodes.h=formatCodes.b;const OneMinute=6e4,TIMEZONE_PATTERN=/([zZ]|([+-])(\d{2}):?(\d{2}))$/,monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort=monthNames.map((e=>e.slice(0,3))),dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort=dayNames.map((e=>e.slice(0,3)));class LiquidDate{constructor(e,t,i){this.locale=t,this.DateTimeFormat=getDateTimeFormat(),this.date=new Date(e),this.timezoneFixed=void 0!==i,void 0===i&&(i=this.date.getTimezoneOffset()),this.timezoneOffset=isString(i)?LiquidDate.getTimezoneOffset(i,this.date):i,this.timezoneName=isString(i)?i:"";const s=6e4*(this.date.getTimezoneOffset()-this.timezoneOffset),r=this.date.getTime()+s;this.displayDate=new Date(r)}getTime(){return this.displayDate.getTime()}getMilliseconds(){return this.displayDate.getMilliseconds()}getSeconds(){return this.displayDate.getSeconds()}getMinutes(){return this.displayDate.getMinutes()}getHours(){return this.displayDate.getHours()}getDay(){return this.displayDate.getDay()}getDate(){return this.displayDate.getDate()}getMonth(){return this.displayDate.getMonth()}getFullYear(){return this.displayDate.getFullYear()}toLocaleString(e,t){return(null==t?void 0:t.timeZone)?this.date.toLocaleString(e,t):this.displayDate.toLocaleString(e,t)}toLocaleTimeString(e){return this.displayDate.toLocaleTimeString(e)}toLocaleDateString(e){return this.displayDate.toLocaleDateString(e)}getTimezoneOffset(){return this.timezoneOffset}getTimeZoneName(){return this.timezoneFixed?this.timezoneName:this.DateTimeFormat?this.DateTimeFormat().resolvedOptions().timeZone:void 0}getLongMonthName(){var e;return null!==(e=this.format({month:"long"}))&&void 0!==e?e:monthNames[this.getMonth()]}getShortMonthName(){var e;return null!==(e=this.format({month:"short"}))&&void 0!==e?e:monthNamesShort[this.getMonth()]}getLongWeekdayName(){var e;return null!==(e=this.format({weekday:"long"}))&&void 0!==e?e:dayNames[this.displayDate.getDay()]}getShortWeekdayName(){var e;return null!==(e=this.format({weekday:"short"}))&&void 0!==e?e:dayNamesShort[this.displayDate.getDay()]}valid(){return!isNaN(this.getTime())}format(e){return this.DateTimeFormat&&this.DateTimeFormat(this.locale,e).format(this.displayDate)}static createDateFixedToTimezone(e,t){const i=e.match(TIMEZONE_PATTERN);if(i&&"Z"===i[1])return new LiquidDate(+new Date(e),t,0);if(i&&i[2]&&i[3]&&i[4]){const[,,s,r,n]=i,o=("+"===s?-1:1)*(60*parseInt(r,10)+parseInt(n,10));return new LiquidDate(+new Date(e),t,o)}return new LiquidDate(e,t)}static getTimezoneOffset(e,t){const i=t.toLocaleString("en-US",{timeZone:e}),s=t.toLocaleString("en-US",{timeZone:"UTC"}),r=new Date(i);return(+new Date(s)-+r)/6e4}}class Limiter{constructor(e,t){this.base=0,this.message=`${e} limit exceeded`,this.limit=t}use(e){e=toNumber(e),assert(this.base+e<=this.limit,this.message),this.base+=e}check(e){assert((e=toNumber(e))<=this.limit,this.message)}}class DelimitedToken extends Token{constructor(e,[t,i],s,r,n,o,a,l){super(e,s,r,n,l),this.trimLeft=!1,this.trimRight=!1;const c="-"===s[t],u="-"===s[i-1];let h=c?t+1:t,p=u?i-1:i;for(;h<p&&4&TYPES[s.charCodeAt(h)];)h++;for(;p>h&&4&TYPES[s.charCodeAt(p-1)];)p--;this.contentRange=[h,p],this.trimLeft=c||o,this.trimRight=u||a}get content(){return this.input.slice(this.contentRange[0],this.contentRange[1])}}class TagToken extends DelimitedToken{constructor(e,t,i,s,r){const{trimTagLeft:n,trimTagRight:o,tagDelimiterLeft:a,tagDelimiterRight:l}=s,[c,u]=[t+a.length,i-l.length];super(TokenKind.Tag,[c,u],e,t,i,n,o,r),this.tokenizer=new Tokenizer(e,s.operators,r,this.contentRange),this.name=this.tokenizer.readTagName(),this.tokenizer.assert(this.name,"illegal tag syntax, tag name expected"),this.tokenizer.skipBlank(),this.args=this.tokenizer.input.slice(this.tokenizer.p,this.contentRange[1])}}class OutputToken extends DelimitedToken{constructor(e,t,i,s,r){const{trimOutputLeft:n,trimOutputRight:o,outputDelimiterLeft:a,outputDelimiterRight:l}=s,c=[t+a.length,i-l.length];super(TokenKind.Output,c,e,t,i,n,o,r)}}class HTMLToken extends Token{constructor(e,t,i,s){super(TokenKind.HTML,e,t,i,s),this.input=e,this.begin=t,this.end=i,this.file=s,this.trimLeft=0,this.trimRight=0}getContent(){return this.input.slice(this.begin+this.trimLeft,this.end-this.trimRight)}}class NumberToken extends Token{constructor(e,t,i,s){super(TokenKind.Number,e,t,i,s),this.input=e,this.begin=t,this.end=i,this.file=s,this.content=Number(this.getText())}}class IdentifierToken extends Token{constructor(e,t,i,s){super(TokenKind.Word,e,t,i,s),this.input=e,this.begin=t,this.end=i,this.file=s,this.content=this.getText()}}class LiteralToken extends Token{constructor(e,t,i,s){super(TokenKind.Literal,e,t,i,s),this.input=e,this.begin=t,this.end=i,this.file=s,this.literal=this.getText(),this.content=literalValues[this.literal]}}const operatorPrecedences={"==":2,"!=":2,">":2,"<":2,">=":2,"<=":2,contains:2,not:1,and:0,or:0},operatorTypes={"==":0,"!=":0,">":0,"<":0,">=":0,"<=":0,contains:0,not:1,and:0,or:0};class OperatorToken extends Token{constructor(e,t,i,s){super(TokenKind.Operator,e,t,i,s),this.input=e,this.begin=t,this.end=i,this.file=s,this.operator=this.getText()}getPrecedence(){const e=this.getText();return e in operatorPrecedences?operatorPrecedences[e]:1}}class PropertyAccessToken extends Token{constructor(e,t,i,s,r,n){super(TokenKind.PropertyAccess,i,s,r,n),this.variable=e,this.props=t}}class FilterToken extends Token{constructor(e,t,i,s,r,n){super(TokenKind.Filter,i,s,r,n),this.name=e,this.args=t}}class HashToken extends Token{constructor(e,t,i,s,r,n){super(TokenKind.Hash,e,t,i,n),this.input=e,this.begin=t,this.end=i,this.name=s,this.value=r,this.file=n}}const rHex=/[\da-fA-F]/,rOct=/[0-7]/,escapeChar={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"};function hexVal(e){const t=e.charCodeAt(0);return t>=97?t-87:t>=65?t-55:t-48}function parseStringLiteral(e){let t="";for(let i=1;i<e.length-1;i++)if("\\"===e[i])if(void 0!==escapeChar[e[i+1]])t+=escapeChar[e[++i]];else if("u"===e[i+1]){let s=0,r=i+2;for(;r<=i+5&&rHex.test(e[r]);)s=16*s+hexVal(e[r++]);i=r-1,t+=String.fromCharCode(s)}else if(rOct.test(e[i+1])){let s=i+1,r=0;for(;s<=i+3&&rOct.test(e[s]);)r=8*r+hexVal(e[s++]);i=s-1,t+=String.fromCharCode(r)}else t+=e[++i];else t+=e[i];return t}class QuotedToken extends Token{constructor(e,t,i,s){super(TokenKind.Quoted,e,t,i,s),this.input=e,this.begin=t,this.end=i,this.file=s,this.content=parseStringLiteral(this.getText())}}class RangeToken extends Token{constructor(e,t,i,s,r,n){super(TokenKind.Range,e,t,i,n),this.input=e,this.begin=t,this.end=i,this.lhs=s,this.rhs=r,this.file=n}}class LiquidTagToken extends DelimitedToken{constructor(e,t,i,s,r){super(TokenKind.Tag,[t,i],e,t,i,!1,!1,r),this.tokenizer=new Tokenizer(e,s.operators,r,this.contentRange),this.name=this.tokenizer.readTagName(),this.tokenizer.assert(this.name,"illegal liquid tag syntax"),this.tokenizer.skipBlank()}get args(){return this.tokenizer.input.slice(this.tokenizer.p,this.contentRange[1])}}class FilteredValueToken extends Token{constructor(e,t,i,s,r,n){super(TokenKind.FilteredValue,i,s,r,n),this.initial=e,this.filters=t,this.input=i,this.begin=s,this.end=r,this.file=n}}const polyfill={now:()=>Date.now()};function getPerformance(){return"object"==typeof global&&global.performance||"object"==typeof window&&window.performance||polyfill}class SimpleEmitter{constructor(){this.buffer=""}write(e){this.buffer+=stringify(e)}}class StreamedEmitter{constructor(){throw this.buffer="",this.stream=null,new Error("streaming not supported in browser")}}class KeepingTypeEmitter{constructor(){this.buffer=""}write(e){"string"!=typeof(e=toValue(e))&&""===this.buffer?this.buffer=e:this.buffer=stringify(this.buffer)+stringify(e)}}class Render{renderTemplatesToNodeStream(e,t){const i=new StreamedEmitter;return Promise.resolve().then((()=>toPromise(this.renderTemplates(e,t,i)))).then((()=>i.end()),(e=>i.error(e))),i.stream}*renderTemplates(e,t,i){i||(i=t.opts.keepOutputType?new KeepingTypeEmitter:new SimpleEmitter);const s=[];for(const r of e){t.renderLimit.check(getPerformance().now());try{const e=yield r.render(t,i);if(e&&i.write(e),t.breakCalled||t.continueCalled)break}catch(e){const i=LiquidError.is(e)?e:new RenderError(e,r);if(!t.opts.catchAllErrors)throw i;s.push(i)}}if(s.length)throw new LiquidErrors(s);return i.buffer}}class Expression{constructor(e){this.postfix=[...toPostfix(e)]}*evaluate(e,t){assert(e,"unable to evaluate: context not defined");const i=[];for(const s of this.postfix)if(isOperatorToken(s)){const t=i.pop();let r;if(1===operatorTypes[s.operator])r=yield e.opts.operators[s.operator](t,e);else{const n=i.pop();r=yield e.opts.operators[s.operator](n,t,e)}i.push(r)}else i.push(yield evalToken(s,e,t));return i[0]}valid(){return!!this.postfix.length}}function*evalToken(e,t,i=!1){if(e)return"content"in e?e.content:isPropertyAccessToken(e)?yield evalPropertyAccessToken(e,t,i):isRangeToken(e)?yield evalRangeToken(e,t):void 0}function*evalPropertyAccessToken(e,t,i){const s=[];for(const i of e.props)s.push(yield evalToken(i,t,!1));try{if(e.variable){const r=yield evalToken(e.variable,t,i);return yield t._getFromScope(r,s)}return yield t._get(s)}catch(t){if(i&&"InternalUndefinedVariableError"===t.name)return null;throw new UndefinedVariableError(t,e)}}function evalQuotedToken(e){return e.content}function*evalRangeToken(e,t){const i=yield evalToken(e.lhs,t),s=yield evalToken(e.rhs,t);return t.memoryLimit.use(s-i+1),range(+i,+s+1)}function*toPostfix(e){const t=[];for(const i of e)if(isOperatorToken(i)){for(;t.length&&t[t.length-1].getPrecedence()>i.getPrecedence();)yield t.pop();t.push(i)}else yield i;for(;t.length;)yield t.pop()}function isTruthy(e,t){return!isFalsy(e,t)}function isFalsy(e,t){return e=toValue(e),t.opts.jsTruthy?!e:!1===e||null==e}const defaultOperators={"==":equals,"!=":(e,t)=>!equals(e,t),">":(e,t)=>isComparable(e)?e.gt(t):isComparable(t)?t.lt(e):toValue(e)>toValue(t),"<":(e,t)=>isComparable(e)?e.lt(t):isComparable(t)?t.gt(e):toValue(e)<toValue(t),">=":(e,t)=>isComparable(e)?e.geq(t):isComparable(t)?t.leq(e):toValue(e)>=toValue(t),"<=":(e,t)=>isComparable(e)?e.leq(t):isComparable(t)?t.geq(e):toValue(e)<=toValue(t),contains:(e,t)=>isArray(e=toValue(e))?e.some((e=>equals(e,t))):!!isFunction(null==e?void 0:e.indexOf)&&e.indexOf(toValue(t))>-1,not:(e,t)=>isFalsy(toValue(e),t),and:(e,t,i)=>isTruthy(toValue(e),i)&&isTruthy(toValue(t),i),or:(e,t,i)=>isTruthy(toValue(e),i)||isTruthy(toValue(t),i)};function equals(e,t){return isComparable(e)?e.equals(t):isComparable(t)?t.equals(e):(e=toValue(e),t=toValue(t),isArray(e)?isArray(t)&&arrayEquals(e,t):e===t)}function arrayEquals(e,t){return e.length===t.length&&!e.some(((e,i)=>!equals(e,t[i])))}function arrayIncludes(e,t){return e.some((e=>equals(e,t)))}class Node{constructor(e,t,i,s){this.key=e,this.value=t,this.next=i,this.prev=s}}class LRU{constructor(e,t=0){this.limit=e,this.size=t,this.cache={},this.head=new Node("HEAD",null,null,null),this.tail=new Node("TAIL",null,null,null),this.head.next=this.tail,this.tail.prev=this.head}write(e,t){if(this.cache[e])this.cache[e].value=t;else{const i=new Node(e,t,this.head.next,this.head);this.head.next.prev=i,this.head.next=i,this.cache[e]=i,this.size++,this.ensureLimit()}}read(e){if(!this.cache[e])return;const{value:t}=this.cache[e];return this.remove(e),this.write(e,t),t}remove(e){const t=this.cache[e];t.prev.next=t.next,t.next.prev=t.prev,delete this.cache[e],this.size--}clear(){this.head.next=this.tail,this.tail.prev=this.head,this.size=0,this.cache={}}ensureLimit(){this.size>this.limit&&this.remove(this.tail.prev.key)}}function domResolve(e,t){const i=document.createElement("base");i.href=e;const s=document.getElementsByTagName("head")[0];s.insertBefore(i,s.firstChild);const r=document.createElement("a");r.href=t;const n=r.href;return s.removeChild(i),n}function resolve(e,t,i){e.length&&"/"!==last(e)&&(e+="/");return domResolve(e,t).replace(/^(\w+:\/\/[^/]+)(\/[^?]+)/,((e,t,s)=>{const r=s.split("/").pop();return/\.\w+$/.test(r)?e:t+s+i}))}function readFile(e){return __awaiter(this,void 0,void 0,(function*(){return new Promise(((t,i)=>{const s=new XMLHttpRequest;s.onload=()=>{s.status>=200&&s.status<300?t(s.responseText):i(new Error(s.statusText))},s.onerror=()=>{i(new Error("An error occurred whilst receiving the response."))},s.open("GET",e),s.send()}))}))}function readFileSync(e){const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(),t.status<200||t.status>=300)throw new Error(t.statusText);return t.responseText}function exists(e){return __awaiter(this,void 0,void 0,(function*(){return!0}))}function existsSync(e){return!0}function dirname(e){return domResolve(e,".")}const sep="/";var fs=Object.freeze({__proto__:null,resolve:resolve,readFile:readFile,readFileSync:readFileSync,exists:exists,existsSync:existsSync,dirname:dirname,sep:"/"});function defaultFilter(e,t,...i){return isArray(e=toValue(e))||isString(e)?e.length?e:t:(!1!==e||!new Map(i).get("allow_false"))&&(isFalsy(e,this.context)?t:e)}function json(e,t=0){return JSON.stringify(e,null,t)}function inspect(e,t=0){const i=[];return JSON.stringify(e,(function(e,t){if("object"!=typeof t||null===t)return t;for(;i.length>0&&i[i.length-1]!==this;)i.pop();return i.includes(t)?"[Circular]":(i.push(t),t)}),t)}function to_integer(e){return Number(e)}const raw={raw:!0,handler:identify};var misc={default:defaultFilter,raw:raw,jsonify:json,to_integer:to_integer,json:json,inspect:inspect};const escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},unescapeMap={"&amp;":"&","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'"};function escape(e){return e=stringify(e),this.context.memoryLimit.use(e.length),e.replace(/&|<|>|"|'/g,(e=>escapeMap[e]))}function xml_escape(e){return escape.call(this,e)}function unescape(e){return e=stringify(e),this.context.memoryLimit.use(e.length),e.replace(/&(amp|lt|gt|#34|#39);/g,(e=>unescapeMap[e]))}function escape_once(e){return escape.call(this,unescape.call(this,e))}function newline_to_br(e){const t=stringify(e);return this.context.memoryLimit.use(t.length),t.replace(/\r?\n/gm,"<br />\n")}function strip_html(e){const t=stringify(e);return this.context.memoryLimit.use(t.length),t.replace(/<script[\s\S]*?<\/script>|<style[\s\S]*?<\/style>|<.*?>|<!--[\s\S]*?-->/g,"")}var htmlFilters=Object.freeze({__proto__:null,escape:escape,xml_escape:xml_escape,escape_once:escape_once,newline_to_br:newline_to_br,strip_html:strip_html});class MapFS{constructor(e){this.mapping=e,this.sep="/"}exists(e){return __awaiter(this,void 0,void 0,(function*(){return this.existsSync(e)}))}existsSync(e){return!isNil(this.mapping[e])}readFile(e){return __awaiter(this,void 0,void 0,(function*(){return this.readFileSync(e)}))}readFileSync(e){const t=this.mapping[e];if(isNil(t))throw new Error(`ENOENT: ${e}`);return t}dirname(e){const t=e.split(this.sep);return t.pop(),t.join(this.sep)}resolve(e,t,i){if(t+=i,"."===e)return t;const s=e.split(/\/+/);for(const e of t.split(this.sep))"."!==e&&""!==e&&(".."===e?(s.length>1||""!==s[0])&&s.pop():s.push(e));return s.join(this.sep)}}const defaultOptions={root:["."],layouts:["."],partials:["."],relativeReference:!0,jekyllInclude:!1,keyValueSeparator:":",cache:void 0,extname:"",fs:fs,dynamicPartials:!0,jsTruthy:!1,dateFormat:"%A, %B %-e, %Y at %-l:%M %P %z",locale:"",trimTagRight:!1,trimTagLeft:!1,trimOutputRight:!1,trimOutputLeft:!1,greedy:!0,tagDelimiterLeft:"{%",tagDelimiterRight:"%}",outputDelimiterLeft:"{{",outputDelimiterRight:"}}",preserveTimezones:!1,strictFilters:!1,strictVariables:!1,ownPropertyOnly:!0,lenientIf:!1,globals:{},keepOutputType:!1,operators:defaultOperators,memoryLimit:1/0,parseLimit:1/0,renderLimit:1/0};function normalize(e){var t,i;if(e.hasOwnProperty("root")&&(e.hasOwnProperty("partials")||(e.partials=e.root),e.hasOwnProperty("layouts")||(e.layouts=e.root)),e.hasOwnProperty("cache")){let t;t="number"==typeof e.cache?e.cache>0?new LRU(e.cache):void 0:"object"==typeof e.cache?e.cache:e.cache?new LRU(1024):void 0,e.cache=t}return(e=Object.assign(Object.assign(Object.assign({},defaultOptions),e.jekyllInclude?{dynamicPartials:!1}:{}),e)).fs.dirname&&e.fs.sep||!e.relativeReference||(console.warn("[LiquidJS] `fs.dirname` and `fs.sep` are required for relativeReference, set relativeReference to `false` to suppress this warning"),e.relativeReference=!1),e.root=normalizeDirectoryList(e.root),e.partials=normalizeDirectoryList(e.partials),e.layouts=normalizeDirectoryList(e.layouts),e.outputEscape=e.outputEscape&&getOutputEscapeFunction(e.outputEscape),e.locale||(e.locale=null!==(i=null===(t=getDateTimeFormat())||void 0===t?void 0:t().resolvedOptions().locale)&&void 0!==i?i:"en-US"),e.templates&&(e.fs=new MapFS(e.templates),e.relativeReference=!0,e.root=e.partials=e.layouts="."),e}function getOutputEscapeFunction(e){return"escape"===e?escape:"json"===e?misc.json:(assert(isFunction(e),"`outputEscape` need to be of type string or function"),e)}function normalizeDirectoryList(e){let t=[];return isArray(e)&&(t=e),isString(e)&&(t=[e]),t}function whiteSpaceCtrl(e,t){let i=!1;for(let s=0;s<e.length;s++){const r=e[s];isDelimitedToken(r)&&(!i&&r.trimLeft&&trimLeft(e[s-1],t.greedy),isTagToken(r)&&("raw"===r.name?i=!0:"endraw"===r.name&&(i=!1)),!i&&r.trimRight&&trimRight(e[s+1],t.greedy))}}function trimLeft(e,t){if(!e||!isHTMLToken(e))return;const i=t?4:16;for(;TYPES[e.input.charCodeAt(e.end-1-e.trimRight)]&i;)e.trimRight++}function trimRight(e,t){if(!e||!isHTMLToken(e))return;const i=t?4:16;for(;TYPES[e.input.charCodeAt(e.begin+e.trimLeft)]&i;)e.trimLeft++;"\n"===e.input.charAt(e.begin+e.trimLeft)&&e.trimLeft++}class Tokenizer{constructor(e,t=defaultOptions.operators,i,s){this.input=e,this.file=i,this.rawBeginAt=-1,this.p=s?s[0]:0,this.N=s?s[1]:e.length,this.opTrie=createTrie(t),this.literalTrie=createTrie(literalValues)}readExpression(){return new Expression(this.readExpressionTokens())}*readExpressionTokens(){for(;this.p<this.N;){const e=this.readOperator();if(e){yield e;continue}const t=this.readValue();if(!t)return;yield t}}readOperator(){this.skipBlank();const e=this.matchTrie(this.opTrie);if(-1!==e)return new OperatorToken(this.input,this.p,this.p=e,this.file)}matchTrie(e){let t,i=e,s=this.p;for(;i[this.input[s]]&&s<this.N;)i=i[this.input[s++]],i.end&&(t=i);return t?t.needBoundary&&isWord(this.peek(s-this.p))?-1:s:-1}readFilteredValue(){const e=this.p,t=this.readExpression();this.assert(t.valid(),`invalid value expression: ${this.snapshot()}`);const i=this.readFilters();return new FilteredValueToken(t,i,this.input,e,this.p,this.file)}readFilters(){const e=[];for(;;){const t=this.readFilter();if(!t)return e;e.push(t)}}readFilter(){if(this.skipBlank(),this.end())return null;this.assert("|"===this.read(),'expected "|" before filter');const e=this.readIdentifier();if(!e.size())return this.assert(this.end(),"expected filter name"),null;const t=[];if(this.skipBlank(),":"===this.peek())do{++this.p;const e=this.readFilterArg();e&&t.push(e),this.skipBlank(),this.assert(this.end()||","===this.peek()||"|"===this.peek(),(()=>`unexpected character ${this.snapshot()}`))}while(","===this.peek());else if("|"!==this.peek()&&!this.end())throw this.error('expected ":" after filter name');return new FilterToken(e.getText(),t,this.input,e.begin,this.p,this.file)}readFilterArg(){const e=this.readValue();if(!e)return;if(this.skipBlank(),":"!==this.peek())return e;++this.p;const t=this.readValue();return[e.getText(),t]}readTopLevelTokens(e=defaultOptions){const t=[];for(;this.p<this.N;){const i=this.readTopLevelToken(e);t.push(i)}return whiteSpaceCtrl(t,e),t}readTopLevelToken(e){const{tagDelimiterLeft:t,outputDelimiterLeft:i}=e;return this.rawBeginAt>-1?this.readEndrawOrRawContent(e):this.match(t)?this.readTagToken(e):this.match(i)?this.readOutputToken(e):this.readHTMLToken([t,i])}readHTMLToken(e){const t=this.p;for(;this.p<this.N&&!e.some((e=>this.match(e)));)++this.p;return new HTMLToken(this.input,t,this.p,this.file)}readTagToken(e){const{file:t,input:i}=this,s=this.p;if(-1===this.readToDelimiter(e.tagDelimiterRight))throw this.error(`tag ${this.snapshot(s)} not closed`,s);const r=new TagToken(i,s,this.p,e,t);return"raw"===r.name&&(this.rawBeginAt=s),r}readToDelimiter(e,t=!1){for(this.skipBlank();this.p<this.N;)if(t&&8&this.peekType())this.readQuoted();else if(++this.p,this.rmatch(e))return this.p;return-1}readOutputToken(e=defaultOptions){const{file:t,input:i}=this,{outputDelimiterRight:s}=e,r=this.p;if(-1===this.readToDelimiter(s,!0))throw this.error(`output ${this.snapshot(r)} not closed`,r);return new OutputToken(i,r,this.p,e,t)}readEndrawOrRawContent(e){const{tagDelimiterLeft:t,tagDelimiterRight:i}=e,s=this.p;let r=this.readTo(t)-t.length;for(;this.p<this.N;)if("endraw"===this.readIdentifier().getText())for(;this.p<=this.N;){if(this.rmatch(i)){const t=this.p;return s===r?(this.rawBeginAt=-1,new TagToken(this.input,s,t,e,this.file)):(this.p=r,new HTMLToken(this.input,s,r,this.file))}if(this.rmatch(t))break;this.p++}else r=this.readTo(t)-t.length;throw this.error(`raw ${this.snapshot(this.rawBeginAt)} not closed`,s)}readLiquidTagTokens(e=defaultOptions){const t=[];for(;this.p<this.N;){const i=this.readLiquidTagToken(e);i&&t.push(i)}return t}readLiquidTagToken(e){if(this.skipBlank(),this.end())return;const t=this.p;this.readToDelimiter("\n");const i=this.p;return new LiquidTagToken(this.input,t,i,e,this.file)}error(e,t=this.p){return new TokenizationError(e,new IdentifierToken(this.input,t,this.N,this.file))}assert(e,t,i){if(!e)throw this.error("function"==typeof t?t():t,i)}snapshot(e=this.p){return JSON.stringify(ellipsis(this.input.slice(e,this.N),32))}readWord(){return this.readIdentifier()}readIdentifier(){this.skipBlank();const e=this.p;for(;!this.end()&&isWord(this.peek());)++this.p;return new IdentifierToken(this.input,e,this.p,this.file)}readNonEmptyIdentifier(){const e=this.readIdentifier();return e.size()?e:void 0}readTagName(){return this.skipBlank(),"#"===this.input[this.p]?this.input.slice(this.p,++this.p):this.readIdentifier().getText()}readHashes(e){const t=[];for(;;){const i=this.readHash(e);if(!i)return t;t.push(i)}}readHash(e){this.skipBlank(),","===this.peek()&&++this.p;const t=this.p,i=this.readNonEmptyIdentifier();if(!i)return;let s;this.skipBlank();const r=isString(e)?e:e?"=":":";return this.peek()===r&&(++this.p,s=this.readValue()),new HashToken(this.input,t,this.p,i,s,this.file)}remaining(){return this.input.slice(this.p,this.N)}advance(e=1){this.p+=e}end(){return this.p>=this.N}read(){return this.input[this.p++]}readTo(e){for(;this.p<this.N;)if(++this.p,this.rmatch(e))return this.p;return-1}readValue(){this.skipBlank();const e=this.p,t=this.readLiteral()||this.readQuoted()||this.readRange()||this.readNumber(),i=this.readProperties(!t);return i.length?new PropertyAccessToken(t,i,this.input,e,this.p):t}readScopeValue(){this.skipBlank();const e=this.p,t=this.readProperties();if(t.length)return new PropertyAccessToken(void 0,t,this.input,e,this.p)}readProperties(e=!0){const t=[];for(;;)if("["!==this.peek()){if(e&&!t.length){const e=this.readNonEmptyIdentifier();if(e){t.push(e);continue}}if("."!==this.peek()||"."===this.peek(1))break;{this.p++;const e=this.readNonEmptyIdentifier();if(!e)break;t.push(e)}}else{this.p++;const e=this.readValue()||new IdentifierToken(this.input,this.p,this.p,this.file);this.assert(-1!==this.readTo("]"),"[ not closed"),t.push(e)}return t}readNumber(){this.skipBlank();let e=!1,t=!1,i=0;for(64&this.peekType()&&i++;this.p+i<=this.N;)if(32&this.peekType(i))t=!0,i++;else{if("."!==this.peek(i)||"."===this.peek(i+1))break;if(e||!t)return;e=!0,i++}if(t&&!isWord(this.peek(i))){const e=new NumberToken(this.input,this.p,this.p+i,this.file);return this.advance(i),e}}readLiteral(){this.skipBlank();const e=this.matchTrie(this.literalTrie);if(-1===e)return;const t=new LiteralToken(this.input,this.p,e,this.file);return this.p=e,t}readRange(){this.skipBlank();const e=this.p;if("("!==this.peek())return;++this.p;const t=this.readValueOrThrow();this.skipBlank(),this.assert("."===this.read()&&"."===this.read(),"invalid range syntax");const i=this.readValueOrThrow();return this.skipBlank(),this.assert(")"===this.read(),"invalid range syntax"),new RangeToken(this.input,e,this.p,t,i,this.file)}readValueOrThrow(){const e=this.readValue();return this.assert(e,(()=>`unexpected token ${this.snapshot()}, value expected`)),e}readQuoted(){this.skipBlank();const e=this.p;if(!(8&this.peekType()))return;++this.p;let t=!1;for(;this.p<this.N&&(++this.p,this.input[this.p-1]!==this.input[e]||t);)t?t=!1:"\\"===this.input[this.p-1]&&(t=!0);return new QuotedToken(this.input,e,this.p,this.file)}*readFileNameTemplate(e){const{outputDelimiterLeft:t}=e,i=[","," ",t],s=new Set(i);for(;this.p<this.N&&!s.has(this.peek());)yield this.match(t)?this.readOutputToken(e):this.readHTMLToken(i)}match(e){for(let t=0;t<e.length;t++)if(e[t]!==this.input[this.p+t])return!1;return!0}rmatch(e){for(let t=0;t<e.length;t++)if(e[e.length-1-t]!==this.input[this.p-1-t])return!1;return!0}peekType(e=0){return this.p+e>=this.N?0:TYPES[this.input.charCodeAt(this.p+e)]}peek(e=0){return this.p+e>=this.N?"":this.input[this.p+e]}skipBlank(){for(;4&this.peekType();)++this.p}}class ParseStream{constructor(e,t){this.handlers={},this.stopRequested=!1,this.tokens=e,this.parseToken=t}on(e,t){return this.handlers[e]=t,this}trigger(e,t){const i=this.handlers[e];return!!i&&(i.call(this,t),!0)}start(){let e;for(this.trigger("start");!this.stopRequested&&(e=this.tokens.shift());){if(this.trigger("token",e))continue;if(isTagToken(e)&&this.trigger(`tag:${e.name}`,e))continue;const t=this.parseToken(e,this.tokens);this.trigger("template",t)}return this.stopRequested||this.trigger("end"),this}stop(){return this.stopRequested=!0,this}}class TemplateImpl{constructor(e){this.token=e}}class Tag extends TemplateImpl{constructor(e,t,i){super(e),this.name=e.name,this.liquid=i,this.tokenizer=e.tokenizer}}class Hash{constructor(e,t){this.hash={};const i=e instanceof Tokenizer?e:new Tokenizer(e,{});for(const e of i.readHashes(t))this.hash[e.name.content]=e.value}*render(e){const t={};for(const i of Object.keys(this.hash))t[i]=void 0===this.hash[i]||(yield evalToken(this.hash[i],e));return t}}function createTagClass(e){return class extends Tag{constructor(t,i,s){super(t,i,s),isFunction(e.parse)&&e.parse.call(this,t,i)}*render(t,i){const s=yield new Hash(this.token.args,t.opts.keyValueSeparator).render(t);return yield e.render.call(this,t,i,s)}}}function isKeyValuePair(e){return isArray(e)}class Filter{constructor(e,t,i){this.token=e,this.name=e.name,this.handler=isFunction(t)?t:isFunction(null==t?void 0:t.handler)?t.handler:identify,this.raw=!isFunction(t)&&!!(null==t?void 0:t.raw),this.args=e.args,this.liquid=i}*render(e,t){const i=[];for(const e of this.args)isKeyValuePair(e)?i.push([e[0],yield evalToken(e[1],t)]):i.push(yield evalToken(e,t));return yield this.handler.apply({context:t,token:this.token,liquid:this.liquid},[e,...i])}}class Value{constructor(e,t){this.filters=[];const i="string"==typeof e?new Tokenizer(e,t.options.operators).readFilteredValue():e;this.initial=i.initial,this.filters=i.filters.map((e=>new Filter(e,this.getFilter(t,e.name),t)))}*value(e,t){t=t||e.opts.lenientIf&&this.filters.length>0&&"default"===this.filters[0].name;let i=yield this.initial.evaluate(e,t);for(const t of this.filters)i=yield t.render(i,e);return i}getFilter(e,t){const i=e.filters[t];return assert(i||!e.options.strictFilters,(()=>`undefined filter: ${t}`)),i}}class Output extends TemplateImpl{constructor(e,t){var i;super(e);const s=new Tokenizer(e.input,t.options.operators,e.file,e.contentRange);this.value=new Value(s.readFilteredValue(),t);const r=this.value.filters,n=t.options.outputEscape;if(!(null===(i=r[r.length-1])||void 0===i?void 0:i.raw)&&n){const e=new FilterToken(toString.call(n),[],"",0,0);r.push(new Filter(e,n,t))}}*render(e,t){const i=yield this.value.value(e,!1);t.write(i)}*arguments(){yield this.value}}class HTML extends TemplateImpl{constructor(e){super(e),this.str=e.getContent()}*render(e,t){t.write(this.str)}}class Variable{constructor(e,t){this.segments=e,this.location=t}toString(){return segmentsString(this.segments,!0)}toArray(){return Array.from(function*e(...t){for(const i of t)i instanceof Variable?yield Array.from(e(...i.segments)):yield i}(...this.segments))}}class VariableMap{constructor(){this.map=new Map}get(e){const t=segmentsString([e.segments[0]]);return this.map.has(t)||this.map.set(t,[]),this.map.get(t)}has(e){return this.map.has(segmentsString([e.segments[0]]))}push(e){this.get(e).push(e)}asObject(){return Object.fromEntries(this.map)}}const defaultStaticAnalysisOptions={partials:!0};function*_analyze(e,t,i){const s=new VariableMap,r=new VariableMap,n=new VariableMap,o=new DummyScope(new Set),a=new Set;function l(e,t){s.push(e);const i=t.alias(e);if(void 0!==i){const e=i.segments[0];isString(e)&&!o.has(e)&&r.push(i)}else{const i=e.segments[0];isString(i)&&!t.has(i)&&r.push(e)}for(const i of e.segments)i instanceof Variable&&l(i,t)}function*c(e,s){if(e.arguments)for(const t of e.arguments())for(const e of extractVariables(t))l(e,s);if(e.localScope)for(const t of e.localScope()){s.add(t.content),s.deleteAlias(t.content);const[e,i]=t.getPosition();n.push(new Variable([t.content],{row:e,col:i,file:t.file}))}if(e.children)if(e.partialScope){const r=e.partialScope();if(void 0===r){for(const r of yield e.children(t,i))yield c(r,s);return}if(a.has(r.name))return;const n=new Set,o=r.isolated?new DummyScope(n):s.push(n);for(const e of r.scope)if(isString(e))n.add(e);else{const[t,i]=e;n.add(t);const s=Array.from(extractVariables(i));s.length&&o.setAlias(t,s[0].segments)}for(const s of yield e.children(t,i))yield c(s,o),a.add(r.name);o.pop()}else{e.blockScope&&s.push(new Set(e.blockScope()));for(const r of yield e.children(t,i))yield c(r,s);e.blockScope&&s.pop()}}for(const t of e)yield c(t,o);return{variables:s.asObject(),globals:r.asObject(),locals:n.asObject()}}function analyze(e,t={}){return toPromise(_analyze(e,Object.assign(Object.assign({},defaultStaticAnalysisOptions),t).partials,!1))}function analyzeSync(e,t={}){return toValueSync(_analyze(e,Object.assign(Object.assign({},defaultStaticAnalysisOptions),t).partials,!0))}class DummyScope{constructor(e){this.stack=[{names:e,aliases:new Map}]}has(e){for(const t of this.stack)if(t.names.has(e))return!0;return!1}push(e){return this.stack.push({names:e,aliases:new Map}),this}pop(){var e;return null===(e=this.stack.pop())||void 0===e?void 0:e.names}add(e){this.stack[0].names.add(e)}alias(e){const t=e.segments[0];if(!isString(t))return;const i=this.getAlias(t);return void 0!==i?new Variable([...i,...e.segments.slice(1)],e.location):void 0}setAlias(e,t){this.stack[this.stack.length-1].aliases.set(e,t)}deleteAlias(e){this.stack[this.stack.length-1].aliases.delete(e)}getAlias(e){for(const t of this.stack){if(t.aliases.has(e))return t.aliases.get(e);if(t.names.has(e))return}}}function*extractVariables(e){isValueToken(e)?yield*extractValueTokenVariables(e):e instanceof Value&&(yield*extractFilteredValueVariables(e))}function*extractFilteredValueVariables(e){for(const t of e.initial.postfix)isValueToken(t)&&(yield*extractValueTokenVariables(t));for(const t of e.filters)for(const e of t.args)isKeyValuePair(e)&&e[1]?yield*extractValueTokenVariables(e[1]):isValueToken(e)&&(yield*extractValueTokenVariables(e))}function*extractValueTokenVariables(e){isRangeToken(e)?(yield*extractValueTokenVariables(e.lhs),yield*extractValueTokenVariables(e.rhs)):isPropertyAccessToken(e)&&(yield extractPropertyAccessVariable(e))}function extractPropertyAccessVariable(e){const t=[];let i=e.file;const s=e.props[0];i=i||s.file,isQuotedToken(s)||isNumberToken(s)||isWordToken(s)?t.push(s.content):isPropertyAccessToken(s)&&t.push(...extractPropertyAccessVariable(s).segments);for(const s of e.props.slice(1))i=i||s.file,isQuotedToken(s)||isNumberToken(s)||isWordToken(s)?t.push(s.content):isPropertyAccessToken(s)&&t.push(extractPropertyAccessVariable(s));const[r,n]=e.getPosition();return new Variable(t,{row:r,col:n,file:i})}const RE_PROPERTY=/^[\u0080-\uFFFFa-zA-Z_][\u0080-\uFFFFa-zA-Z0-9_-]*$/;function segmentsString(e,t=!1){const i=[],s=e[0];isString(s)&&(!t||s.match(RE_PROPERTY)?i.push(`${s}`):i.push(`['${s}']`));for(const t of e.slice(1))t instanceof Variable?i.push(`[${segmentsString(t.segments)}]`):isString(t)?t.match(RE_PROPERTY)?i.push(`.${t}`):i.push(`['${t}']`):i.push(`[${t}]`);return i.join("")}var LookupType,TokenKind;!function(e){e.Partials="partials",e.Layouts="layouts",e.Root="root"}(LookupType||(LookupType={}));class Loader{constructor(e){if(this.options=e,e.relativeReference){const t=e.fs.sep;assert(t,"`fs.sep` is required for relative reference");const i=new RegExp(["."+t,".."+t,"./","../"].map((e=>escapeRegex(e))).join("|"));this.shouldLoadRelative=e=>i.test(e)}else this.shouldLoadRelative=e=>!1;this.contains=this.options.fs.contains||(()=>!0)}*lookup(e,t,i,s){const{fs:r}=this.options,n=this.options[t];for(const o of this.candidates(e,n,s,t!==LookupType.Root))if(i?r.existsSync(o):yield r.exists(o))return o;throw this.lookupError(e,n)}*candidates(e,t,i,s){const{fs:r,extname:n}=this.options;if(this.shouldLoadRelative(e)&&i){const o=r.resolve(this.dirname(i),e,n);for(const e of t)if(!s||this.contains(e,o)){yield o;break}}for(const i of t){const t=r.resolve(i,e,n);s&&!this.contains(i,t)||(yield t)}if(void 0!==r.fallback){const t=r.fallback(e);void 0!==t&&(yield t)}}dirname(e){const t=this.options.fs;return assert(t.dirname,"`fs.dirname` is required for relative reference"),t.dirname(e)}lookupError(e,t){const i=new Error("ENOENT");return i.message=`ENOENT: Failed to lookup "${e}" in "${t}"`,i.code="ENOENT",i}}class Parser{constructor(e){this.liquid=e,this.cache=this.liquid.options.cache,this.fs=this.liquid.options.fs,this.parseFile=this.cache?this._parseFileCached:this._parseFile,this.loader=new Loader(this.liquid.options),this.parseLimit=new Limiter("parse length",e.options.parseLimit)}parse(e,t){e=String(e),this.parseLimit.use(e.length);const i=new Tokenizer(e,this.liquid.options.operators,t).readTopLevelTokens(this.liquid.options);return this.parseTokens(i)}parseTokens(e){let t;const i=[],s=[];for(;t=e.shift();)try{i.push(this.parseToken(t,e))}catch(e){if(!this.liquid.options.catchAllErrors)throw e;s.push(e)}if(s.length)throw new LiquidErrors(s);return i}parseToken(e,t){try{if(isTagToken(e)){const i=this.liquid.tags[e.name];return assert(i,`tag "${e.name}" not found`),new i(e,t,this.liquid,this)}return isOutputToken(e)?new Output(e,this.liquid):new HTML(e)}catch(t){if(LiquidError.is(t))throw t;throw new ParseError(t,e)}}parseStream(e){return new ParseStream(e,((e,t)=>this.parseToken(e,t)))}*_parseFileCached(e,t,i=LookupType.Root,s){const r=this.cache,n=this.loader.shouldLoadRelative(e)?s+","+e:i+":"+e,o=yield r.read(n);if(o)return o;const a=this._parseFile(e,t,i,s),l=t?yield a:toPromise(a);r.write(n,l);try{return yield l}catch(e){throw r.remove(n),e}}*_parseFile(e,t,i=LookupType.Root,s){const r=yield this.loader.lookup(e,i,t,s);return this.parse(t?this.fs.readFileSync(r):yield this.fs.readFile(r),r)}}function isDelimitedToken(e){return!!(getKind(e)&TokenKind.Delimited)}function isOperatorToken(e){return getKind(e)===TokenKind.Operator}function isHTMLToken(e){return getKind(e)===TokenKind.HTML}function isOutputToken(e){return getKind(e)===TokenKind.Output}function isTagToken(e){return getKind(e)===TokenKind.Tag}function isQuotedToken(e){return getKind(e)===TokenKind.Quoted}function isLiteralToken(e){return getKind(e)===TokenKind.Literal}function isNumberToken(e){return getKind(e)===TokenKind.Number}function isPropertyAccessToken(e){return getKind(e)===TokenKind.PropertyAccess}function isWordToken(e){return getKind(e)===TokenKind.Word}function isRangeToken(e){return getKind(e)===TokenKind.Range}function isValueToken(e){return(1667&getKind(e))>0}function getKind(e){return e?e.kind:-1}!function(e){e[e.Number=1]="Number",e[e.Literal=2]="Literal",e[e.Tag=4]="Tag",e[e.Output=8]="Output",e[e.HTML=16]="HTML",e[e.Filter=32]="Filter",e[e.Hash=64]="Hash",e[e.PropertyAccess=128]="PropertyAccess",e[e.Word=256]="Word",e[e.Range=512]="Range",e[e.Quoted=1024]="Quoted",e[e.Operator=2048]="Operator",e[e.FilteredValue=4096]="FilteredValue",e[e.Delimited=12]="Delimited"}(TokenKind||(TokenKind={}));var BlockMode,typeGuards=Object.freeze({__proto__:null,isDelimitedToken:isDelimitedToken,isOperatorToken:isOperatorToken,isHTMLToken:isHTMLToken,isOutputToken:isOutputToken,isTagToken:isTagToken,isQuotedToken:isQuotedToken,isLiteralToken:isLiteralToken,isNumberToken:isNumberToken,isPropertyAccessToken:isPropertyAccessToken,isWordToken:isWordToken,isRangeToken:isRangeToken,isValueToken:isValueToken});class Context{constructor(e={},t=defaultOptions,i={},{memoryLimit:s,renderLimit:r}={}){var n,o,a,l,c;this.scopes=[{}],this.registers={},this.breakCalled=!1,this.continueCalled=!1,this.sync=!!i.sync,this.opts=t,this.globals=null!==(n=i.globals)&&void 0!==n?n:t.globals,this.environments=isObject(e)?e:Object(e),this.strictVariables=null!==(o=i.strictVariables)&&void 0!==o?o:this.opts.strictVariables,this.ownPropertyOnly=null!==(a=i.ownPropertyOnly)&&void 0!==a?a:t.ownPropertyOnly,this.memoryLimit=null!=s?s:new Limiter("memory alloc",null!==(l=i.memoryLimit)&&void 0!==l?l:t.memoryLimit),this.renderLimit=null!=r?r:new Limiter("template render",getPerformance().now()+(null!==(c=i.renderLimit)&&void 0!==c?c:t.renderLimit))}getRegister(e){return this.registers[e]=this.registers[e]||{}}setRegister(e,t){return this.registers[e]=t}saveRegister(...e){return e.map((e=>[e,this.getRegister(e)]))}restoreRegister(e){return e.forEach((([e,t])=>this.setRegister(e,t)))}getAll(){return[this.globals,this.environments,...this.scopes].reduce(((e,t)=>__assign(e,t)),{})}get(e){return this.getSync(e)}getSync(e){return toValueSync(this._get(e))}*_get(e){const t=this.findScope(e[0]);return yield this._getFromScope(t,e)}getFromScope(e,t){return toValueSync(this._getFromScope(e,t))}*_getFromScope(e,t,i=this.strictVariables){isString(t)&&(t=t.split("."));for(let s=0;s<t.length;s++)if(e=yield readProperty(e,t[s],this.ownPropertyOnly),i&&isUndefined(e))throw new InternalUndefinedVariableError(t.slice(0,s+1).join("."));return e}push(e){return this.scopes.push(e)}pop(){return this.scopes.pop()}bottom(){return this.scopes[0]}spawn(e={}){return new Context(e,this.opts,{sync:this.sync,globals:this.globals,strictVariables:this.strictVariables},{renderLimit:this.renderLimit,memoryLimit:this.memoryLimit})}findScope(e){for(let t=this.scopes.length-1;t>=0;t--){const i=this.scopes[t];if(e in i)return i}return e in this.environments?this.environments:this.globals}}function readProperty(e,t,i){if(e=toLiquid(e),t=toValue(t),isNil(e))return e;if(isArray(e)&&t<0)return e[e.length+ +t];const s=readJSProperty(e,t,i);return void 0===s&&e instanceof Drop?e.liquidMethodMissing(t):isFunction(s)?s.call(e):"size"===t?readSize(e):"first"===t?readFirst(e):"last"===t?readLast(e):s}function readJSProperty(e,t,i){if(!i||hasOwnProperty.call(e,t)||e instanceof Drop)return e[t]}function readFirst(e){return isArray(e)?e[0]:e.first}function readLast(e){return isArray(e)?e[e.length-1]:e.last}function readSize(e){return hasOwnProperty.call(e,"size")||void 0!==e.size?e.size:isArray(e)||isString(e)?e.length:"object"==typeof e?Object.keys(e).length:void 0}!function(e){e[e.OUTPUT=0]="OUTPUT",e[e.STORE=1]="STORE"}(BlockMode||(BlockMode={}));const abs=argumentsToValue(Math.abs),at_least=argumentsToValue(Math.max),at_most=argumentsToValue(Math.min),ceil=argumentsToValue(Math.ceil),divided_by=argumentsToValue(((e,t,i=!1)=>i?Math.floor(e/t):e/t)),floor=argumentsToValue(Math.floor),minus=argumentsToValue(((e,t)=>e-t)),modulo=argumentsToValue(((e,t)=>e%t)),times=argumentsToValue(((e,t)=>e*t));function round(e,t=0){e=toValue(e),t=toValue(t);const i=Math.pow(10,t);return Math.round(e*i)/i}function plus(e,t){return e=toValue(e),t=toValue(t),Number(e)+Number(t)}var mathFilters=Object.freeze({__proto__:null,abs:abs,at_least:at_least,at_most:at_most,ceil:ceil,divided_by:divided_by,floor:floor,minus:minus,modulo:modulo,times:times,round:round,plus:plus});const url_decode=e=>decodeURIComponent(stringify(e)).replace(/\+/g," "),url_encode=e=>encodeURIComponent(stringify(e)).replace(/%20/g,"+"),cgi_escape=e=>encodeURIComponent(stringify(e)).replace(/%20/g,"+").replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())),uri_escape=e=>encodeURI(stringify(e)).replace(/%5B/g,"[").replace(/%5D/g,"]"),rSlugifyDefault=/[^\p{M}\p{L}\p{Nd}]+/gu,rSlugifyReplacers={raw:/\s+/g,default:rSlugifyDefault,pretty:/[^\p{M}\p{L}\p{Nd}._~!$&'()+,;=@]+/gu,ascii:/[^A-Za-z0-9]+/g,latin:rSlugifyDefault,none:null};function slugify(e,t="default",i=!1){e=stringify(e);const s=rSlugifyReplacers[t];return s&&("latin"===t&&(e=removeAccents(e)),e=e.replace(s,"-").replace(/^-|-$/g,"")),i?e:e.toLowerCase()}function removeAccents(e){return e.replace(/[]/g,"a").replace(/[]/g,"ae").replace(/[]/g,"c").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"d").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[]/g,"ss").replace(/[]/g,"oe").replace(/[]/g,"th").replace(/[]/g,"SS").replace(/[]/g,"OE").replace(/[]/g,"TH")}var urlFilters=Object.freeze({__proto__:null,url_decode:url_decode,url_encode:url_encode,cgi_escape:cgi_escape,uri_escape:uri_escape,slugify:slugify});const join=argumentsToValue((function(e,t){const i=toArray(e),s=isNil(t)?" ":stringify(t),r=i.length*(1+s.length);return this.context.memoryLimit.use(r),i.join(s)})),last$1=argumentsToValue((e=>isArrayLike(e)?last(e):"")),first=argumentsToValue((e=>isArrayLike(e)?e[0]:"")),reverse=argumentsToValue((function(e){const t=toArray(e);return this.context.memoryLimit.use(t.length),[...t].reverse()}));function*sort(e,t){const i=[],s=toArray(e);this.context.memoryLimit.use(s.length);for(const e of s)i.push([e,t?yield this.context._getFromScope(e,stringify(t).split("."),!1):e]);return i.sort(((e,t)=>{const i=e[1],s=t[1];return i<s?-1:i>s?1:0})).map((e=>e[0]))}function sort_natural(e,t){const i=stringify(t),s=void 0===t?caseInsensitiveCompare:(e,t)=>caseInsensitiveCompare(e[i],t[i]),r=toArray(e);return this.context.memoryLimit.use(r.length),[...r].sort(s)}const size=e=>e&&e.length||0;function*map(e,t){const i=[],s=toArray(e);this.context.memoryLimit.use(s.length);for(const e of s)i.push(yield this.context._getFromScope(e,stringify(t),!1));return i}function*sum(e,t){let i=0;const s=toArray(e);for(const e of s){const s=Number(t?yield this.context._getFromScope(e,stringify(t),!1):e);i+=Number.isNaN(s)?0:s}return i}function compact(e){const t=toArray(e);return this.context.memoryLimit.use(t.length),t.filter((e=>!isNil(toValue(e))))}function concat(e,t=[]){const i=toArray(e),s=toArray(t);return this.context.memoryLimit.use(i.length+s.length),i.concat(s)}function push(e,t){return concat.call(this,e,[t])}function unshift(e,t){const i=toArray(e);this.context.memoryLimit.use(i.length);const s=[...i];return s.unshift(t),s}function pop(e){const t=[...toArray(e)];return t.pop(),t}function shift(e){const t=toArray(e);this.context.memoryLimit.use(t.length);const i=[...t];return i.shift(),i}function slice(e,t,i=1){return isNil(e=toValue(e))?[]:(isArray(e)||(e=stringify(e)),t=t<0?e.length+t:t,this.context.memoryLimit.use(i),e.slice(t,t+i))}function expectedMatcher(e){return this.context.opts.jekyllWhere?t=>EmptyDrop.is(e)?equals(t,e):isArray(t)?arrayIncludes(t,e):equals(t,e):void 0===e?e=>isTruthy(e,this.context):t=>equals(t,e)}function*filter(e,t,i,s){const r=[];t=toArray(t),this.context.memoryLimit.use(t.length);const n=new Tokenizer(stringify(i)).readScopeValue();for(const e of t)r.push(yield evalToken(n,this.context.spawn(e)));const o=expectedMatcher.call(this,s);return t.filter(((t,i)=>o(r[i])===e))}function*filter_exp(e,t,i,s){const r=[],n=new Value(stringify(s),this.liquid),o=toArray(t);this.context.memoryLimit.use(o.length);for(const t of o){this.context.push({[i]:t});const s=yield n.value(this.context);this.context.pop(),s===e&&r.push(t)}return r}function*where(e,t,i){return yield*filter.call(this,!0,e,t,i)}function*reject(e,t,i){return yield*filter.call(this,!1,e,t,i)}function*where_exp(e,t,i){return yield*filter_exp.call(this,!0,e,t,i)}function*reject_exp(e,t,i){return yield*filter_exp.call(this,!1,e,t,i)}function*group_by(e,t){const i=new Map;e=toEnumerable(e);const s=new Tokenizer(stringify(t)).readScopeValue();this.context.memoryLimit.use(e.length);for(const t of e){const e=yield evalToken(s,this.context.spawn(t));i.has(e)||i.set(e,[]),i.get(e).push(t)}return[...i.entries()].map((([e,t])=>({name:e,items:t})))}function*group_by_exp(e,t,i){const s=new Map,r=new Value(stringify(i),this.liquid);e=toEnumerable(e),this.context.memoryLimit.use(e.length);for(const i of e){this.context.push({[t]:i});const e=yield r.value(this.context);this.context.pop(),s.has(e)||s.set(e,[]),s.get(e).push(i)}return[...s.entries()].map((([e,t])=>({name:e,items:t})))}function*search(e,t,i){const s=new Tokenizer(stringify(t)).readScopeValue(),r=toArray(e),n=expectedMatcher.call(this,i);for(let e=0;e<r.length;e++){if(n(yield evalToken(s,this.context.spawn(r[e]))))return[e,r[e]]}}function*search_exp(e,t,i){const s=new Value(stringify(i),this.liquid),r=toArray(e);for(let e=0;e<r.length;e++){this.context.push({[t]:r[e]});const i=yield s.value(this.context);if(this.context.pop(),i)return[e,r[e]]}}function*has(e,t,i){return!!(yield*search.call(this,e,t,i))}function*has_exp(e,t,i){return!!(yield*search_exp.call(this,e,t,i))}function*find_index(e,t,i){const s=yield*search.call(this,e,t,i);return s?s[0]:void 0}function*find_index_exp(e,t,i){const s=yield*search_exp.call(this,e,t,i);return s?s[0]:void 0}function*find(e,t,i){const s=yield*search.call(this,e,t,i);return s?s[1]:void 0}function*find_exp(e,t,i){const s=yield*search_exp.call(this,e,t,i);return s?s[1]:void 0}function uniq(e){return e=toArray(e),this.context.memoryLimit.use(e.length),[...new Set(e)]}function sample(e,t=1){if(isNil(e=toValue(e)))return[];isArray(e)||(e=stringify(e)),this.context.memoryLimit.use(t);const i=[...e].sort((()=>Math.random()-.5));return 1===t?i[0]:i.slice(0,t)}var arrayFilters=Object.freeze({__proto__:null,join:join,last:last$1,first:first,reverse:reverse,sort:sort,sort_natural:sort_natural,size:size,map:map,sum:sum,compact:compact,concat:concat,push:push,unshift:unshift,pop:pop,shift:shift,slice:slice,where:where,reject:reject,where_exp:where_exp,reject_exp:reject_exp,group_by:group_by,group_by_exp:group_by_exp,has:has,has_exp:has_exp,find_index:find_index,find_index_exp:find_index_exp,find:find,find_exp:find_exp,uniq:uniq,sample:sample});function date(e,t,i){var s,r,n;const o=(null!==(s=null==e?void 0:e.length)&&void 0!==s?s:0)+(null!==(r=null==t?void 0:t.length)&&void 0!==r?r:0)+(null!==(n=null==i?void 0:i.length)&&void 0!==n?n:0);this.context.memoryLimit.use(o);const a=parseDate(e,this.context.opts,i);return a?strftime(a,t=isNil(t=toValue(t))?this.context.opts.dateFormat:stringify(t)):e}function date_to_xmlschema(e){return date.call(this,e,"%Y-%m-%dT%H:%M:%S%:z")}function date_to_rfc822(e){return date.call(this,e,"%a, %d %b %Y %H:%M:%S %z")}function date_to_string(e,t,i){return stringify_date.call(this,e,"%b",t,i)}function date_to_long_string(e,t,i){return stringify_date.call(this,e,"%B",t,i)}function stringify_date(e,t,i,s){const r=parseDate(e,this.context.opts);if(!r)return e;if("ordinal"===i){const e=r.getDate();return strftime(r,"US"===s?`${t} ${e}%q, %Y`:`${e}%q ${t} %Y`)}return strftime(r,`%d ${t} %Y`)}function parseDate(e,t,i){let s;const r=null!=i?i:t.timezoneOffset,n=t.locale;return s="now"===(e=toValue(e))||"today"===e?new LiquidDate(Date.now(),n,r):isNumber(e)?new LiquidDate(1e3*e,n,r):isString(e)?/^\d+$/.test(e)?new LiquidDate(1e3*+e,n,r):t.preserveTimezones&&void 0===i?LiquidDate.createDateFixedToTimezone(e,n):new LiquidDate(e,n,r):new LiquidDate(e,n,r),s.valid()?s:void 0}var dateFilters=Object.freeze({__proto__:null,date:date,date_to_xmlschema:date_to_xmlschema,date_to_rfc822:date_to_rfc822,date_to_string:date_to_string,date_to_long_string:date_to_long_string});const rCJKWord=/[\u4E00-\u9FFF\uF900-\uFAFF\u3400-\u4DBF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF]/gu,rNonCJKWord=/[^\u4E00-\u9FFF\uF900-\uFAFF\u3400-\u4DBF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF\s]+/gu;function append(e,t){assert(2===arguments.length,"append expect 2 arguments");const i=stringify(e),s=stringify(t);return this.context.memoryLimit.use(i.length+s.length),i+s}function prepend(e,t){assert(2===arguments.length,"prepend expect 2 arguments");const i=stringify(e),s=stringify(t);return this.context.memoryLimit.use(i.length+s.length),s+i}function lstrip(e,t){const i=stringify(e);return this.context.memoryLimit.use(i.length),t?(t=escapeRegExp(stringify(t)),i.replace(new RegExp(`^[${t}]+`,"g"),"")):i.replace(/^\s+/,"")}function downcase(e){const t=stringify(e);return this.context.memoryLimit.use(t.length),t.toLowerCase()}function upcase(e){const t=stringify(e);return this.context.memoryLimit.use(t.length),stringify(t).toUpperCase()}function remove(e,t){const i=stringify(e);return this.context.memoryLimit.use(i.length),i.split(stringify(t)).join("")}function remove_first(e,t){const i=stringify(e);return this.context.memoryLimit.use(i.length),i.replace(stringify(t),"")}function remove_last(e,t){const i=stringify(e);this.context.memoryLimit.use(i.length);const s=stringify(t),r=i.lastIndexOf(s);return-1===r?i:i.substring(0,r)+i.substring(r+s.length)}function rstrip(e,t){return e=stringify(e),this.context.memoryLimit.use(e.length),t?(t=escapeRegExp(stringify(t)),e.replace(new RegExp(`[${t}]+$`,"g"),"")):e.replace(/\s+$/,"")}function split(e,t){const i=stringify(e);this.context.memoryLimit.use(i.length);const s=i.split(stringify(t));for(;s.length&&""===s[s.length-1];)s.pop();return s}function strip(e,t){const i=stringify(e);return this.context.memoryLimit.use(i.length),t?(t=escapeRegExp(stringify(t)),i.replace(new RegExp(`^[${t}]+`,"g"),"").replace(new RegExp(`[${t}]+$`,"g"),"")):i.trim()}function strip_newlines(e){const t=stringify(e);return this.context.memoryLimit.use(t.length),t.replace(/\r?\n/gm,"")}function capitalize(e){return e=stringify(e),this.context.memoryLimit.use(e.length),e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function replace(e,t,i){const s=stringify(e);return this.context.memoryLimit.use(s.length),s.split(stringify(t)).join(i)}function replace_first(e,t,i){const s=stringify(e);return this.context.memoryLimit.use(s.length),s.replace(stringify(t),i)}function replace_last(e,t,i){const s=stringify(e);this.context.memoryLimit.use(s.length);const r=stringify(t),n=s.lastIndexOf(r);if(-1===n)return s;const o=stringify(i);return s.substring(0,n)+o+s.substring(n+r.length)}function truncate(e,t=50,i="..."){const s=stringify(e);return this.context.memoryLimit.use(s.length),s.length<=t?e:s.substring(0,t-i.length)+i}function truncatewords(e,t=15,i="..."){const s=stringify(e);this.context.memoryLimit.use(s.length);const r=s.split(/\s+/);t<=0&&(t=1);let n=r.slice(0,t).join(" ");return r.length>=t&&(n+=i),n}function normalize_whitespace(e){const t=stringify(e);return this.context.memoryLimit.use(t.length),t.replace(/\s+/g," ")}function number_of_words(e,t){const i=stringify(e);if(this.context.memoryLimit.use(i.length),!(e=i.trim()))return 0;switch(t){case"cjk":return(e.match(rCJKWord)||[]).length+(e.match(rNonCJKWord)||[]).length;case"auto":return rCJKWord.test(e)?e.match(rCJKWord).length+(e.match(rNonCJKWord)||[]).length:e.split(/\s+/).length;default:return e.split(/\s+/).length}}function array_to_sentence_string(e,t="and"){switch(this.context.memoryLimit.use(e.length),e.length){case 0:return"";case 1:return e[0];case 2:return`${e[0]} ${t} ${e[1]}`;default:return`${e.slice(0,-1).join(", ")}, ${t} ${e[e.length-1]}`}}var stringFilters=Object.freeze({__proto__:null,append:append,prepend:prepend,lstrip:lstrip,downcase:downcase,upcase:upcase,remove:remove,remove_first:remove_first,remove_last:remove_last,rstrip:rstrip,split:split,strip:strip,strip_newlines:strip_newlines,capitalize:capitalize,replace:replace,replace_first:replace_first,replace_last:replace_last,truncate:truncate,truncatewords:truncatewords,normalize_whitespace:normalize_whitespace,number_of_words:number_of_words,array_to_sentence_string:array_to_sentence_string});const filters=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},htmlFilters),mathFilters),urlFilters),arrayFilters),dateFilters),stringFilters),misc);class AssignTag extends Tag{constructor(e,t,i){super(e,t,i),this.identifier=this.tokenizer.readIdentifier(),this.key=this.identifier.content,this.tokenizer.assert(this.key,"expected variable name"),this.tokenizer.skipBlank(),this.tokenizer.assert("="===this.tokenizer.peek(),'expected "="'),this.tokenizer.advance(),this.value=new Value(this.tokenizer.readFilteredValue(),this.liquid)}*render(e){e.bottom()[this.key]=yield this.value.value(e,this.liquid.options.lenientIf)}*arguments(){yield this.value}*localScope(){yield this.identifier}}const MODIFIERS=["offset","limit","reversed"];class ForTag extends Tag{constructor(e,t,i,s){super(e,t,i);const r=this.tokenizer.readIdentifier(),n=this.tokenizer.readIdentifier(),o=this.tokenizer.readValue();if(!r.size()||"in"!==n.content||!o)throw new Error(`illegal tag: ${e.getText()}`);let a;this.variable=r.content,this.collection=o,this.hash=new Hash(this.tokenizer,i.options.keyValueSeparator),this.templates=[],this.elseTemplates=[];const l=s.parseStream(t).on("start",(()=>a=this.templates)).on("tag:else",(e=>{assertEmpty(e.args),a=this.elseTemplates})).on("tag:endfor",(e=>{assertEmpty(e.args),l.stop()})).on("template",(e=>a.push(e))).on("end",(()=>{throw new Error(`tag ${e.getText()} not closed`)}));l.start()}*render(e,t){const i=this.liquid.renderer;let s=toEnumerable(yield evalToken(this.collection,e));if(!s.length)return void(yield i.renderTemplates(this.elseTemplates,e,t));const r="continue-"+this.variable+"-"+this.collection.getText();e.push({continue:e.getRegister(r)});const n=yield this.hash.render(e);e.pop();s=(this.liquid.options.orderedFilterParameters?Object.keys(n).filter((e=>MODIFIERS.includes(e))):MODIFIERS.filter((e=>void 0!==n[e]))).reduce(((e,t)=>"offset"===t?offset(e,n.offset):"limit"===t?limit(e,n.limit):reversed(e)),s),e.setRegister(r,(n.offset||0)+s.length);const o={forloop:new ForloopDrop(s.length,this.collection.getText(),this.variable)};e.push(o);for(const r of s){if(o[this.variable]=r,e.continueCalled=e.breakCalled=!1,yield i.renderTemplates(this.templates,e,t),e.breakCalled)break;o.forloop.next()}e.continueCalled=e.breakCalled=!1,e.pop()}*children(){const e=this.templates.slice();return this.elseTemplates&&e.push(...this.elseTemplates),e}*arguments(){yield this.collection;for(const e of Object.values(this.hash.hash))isValueToken(e)&&(yield e)}blockScope(){return[this.variable,"forloop"]}}function reversed(e){return[...e].reverse()}function offset(e,t){return e.slice(t)}function limit(e,t){return e.slice(0,t)}class CaptureTag extends Tag{constructor(e,t,i,s){for(super(e,t,i),this.templates=[],this.identifier=this.readVariable(),this.variable=this.identifier.content;t.length;){const e=t.shift();if(isTagToken(e)&&"endcapture"===e.name)return;this.templates.push(s.parseToken(e,t))}throw new Error(`tag ${e.getText()} not closed`)}readVariable(){let e=this.tokenizer.readIdentifier();if(e.content)return e;if(e=this.tokenizer.readQuoted(),e)return e;throw this.tokenizer.error("invalid capture name")}*render(e){const t=this.liquid.renderer,i=yield t.renderTemplates(this.templates,e);e.bottom()[this.variable]=i}*children(){return this.templates}*localScope(){yield this.identifier}}class CaseTag extends Tag{constructor(e,t,i,s){super(e,t,i),this.branches=[],this.elseTemplates=[],this.value=new Value(this.tokenizer.readFilteredValue(),this.liquid),this.elseTemplates=[];let r=[],n=0;const o=s.parseStream(t).on("tag:when",(e=>{if(n>0)return;r=[];const t=[];for(;!e.tokenizer.end();)t.push(e.tokenizer.readValueOrThrow()),e.tokenizer.skipBlank(),","===e.tokenizer.peek()?e.tokenizer.readTo(","):e.tokenizer.readTo("or");this.branches.push({values:t,templates:r})})).on("tag:else",(()=>{n++,r=this.elseTemplates})).on("tag:endcase",(()=>o.stop())).on("template",(e=>{r===this.elseTemplates&&1!==n||r.push(e)})).on("end",(()=>{throw new Error(`tag ${e.getText()} not closed`)}));o.start()}*render(e,t){const i=this.liquid.renderer,s=toValue(yield this.value.value(e,e.opts.lenientIf));let r=!1;for(const n of this.branches)for(const o of n.values){if(equals(s,yield evalToken(o,e,e.opts.lenientIf))){yield i.renderTemplates(n.templates,e,t),r=!0;break}}r||(yield i.renderTemplates(this.elseTemplates,e,t))}*arguments(){yield this.value,yield*this.branches.flatMap((e=>e.values))}*children(){const e=this.branches.flatMap((e=>e.templates));return this.elseTemplates&&e.push(...this.elseTemplates),e}}class CommentTag extends Tag{constructor(e,t,i){for(super(e,t,i);t.length;){const e=t.shift();if(isTagToken(e)&&"endcomment"===e.name)return}throw new Error(`tag ${e.getText()} not closed`)}render(){}}class RenderTag extends Tag{constructor(e,t,i,s){super(e,t,i);const r=this.tokenizer;for(this.file=parseFilePath(r,this.liquid,s),this.currentFile=e.file;!r.end();){r.skipBlank();const e=r.p,t=r.readIdentifier();if(("with"===t.content||"for"===t.content)&&(r.skipBlank(),":"!==r.peek())){const e=r.readValue();if(e){const i=r.p;let s;"as"===r.readIdentifier().content?s=r.readIdentifier():r.p=i,this[t.content]={value:e,alias:s&&s.content},r.skipBlank(),","===r.peek()&&r.advance();continue}}r.p=e;break}this.hash=new Hash(r,i.options.keyValueSeparator)}*render(e,t){const{liquid:i,hash:s}=this,r=yield renderFilePath(this.file,e,i);assert(r,(()=>`illegal file path "${r}"`));const n=e.spawn(),o=n.bottom();if(__assign(o,yield s.render(e)),this.with){const{value:t,alias:i}=this.with;o[i||r]=yield evalToken(t,e)}if(this.for){const{value:s,alias:a}=this.for,l=toEnumerable(yield evalToken(s,e));o.forloop=new ForloopDrop(l.length,s.getText(),a);for(const e of l){o[a]=e;const s=yield i._parsePartialFile(r,n.sync,this.currentFile);yield i.renderer.renderTemplates(s,n,t),o.forloop.next()}}else{const e=yield i._parsePartialFile(r,n.sync,this.currentFile);yield i.renderer.renderTemplates(e,n,t)}}*children(e,t){return e&&isString(this.file)?yield this.liquid._parsePartialFile(this.file,t,this.currentFile):[]}partialScope(){if(isString(this.file)){const e=Object.keys(this.hash.hash);if(this.with){const{value:t,alias:i}=this.with;isString(i)?e.push([i,t]):isString(this.file)&&e.push([this.file,t])}if(this.for){const{value:t,alias:i}=this.for;isString(i)?e.push([i,t]):isString(this.file)&&e.push([this.file,t])}return{name:this.file,isolated:!0,scope:e}}}*arguments(){for(const e of Object.values(this.hash.hash))isValueToken(e)&&(yield e);if(this.with){const{value:e}=this.with;isValueToken(e)&&(yield e)}if(this.for){const{value:e}=this.for;isValueToken(e)&&(yield e)}}}function parseFilePath(e,t,i){if(t.options.dynamicPartials){const t=e.readValue();if(e.assert(t,"illegal file path"),"none"===t.getText())return;if(isQuotedToken(t)){return optimize(i.parse(evalQuotedToken(t)))}return t}const s=[...e.readFileNameTemplate(t.options)],r=optimize(i.parseTokens(s));return"none"===r?void 0:r}function optimize(e){return 1===e.length&&isHTMLToken(e[0].token)?e[0].token.getContent():e}function*renderFilePath(e,t,i){return"string"==typeof e?e:Array.isArray(e)?i.renderer.renderTemplates(e,t):yield evalToken(e,t)}class IncludeTag extends Tag{constructor(e,t,i,s){super(e,t,i);const{tokenizer:r}=e;this.file=parseFilePath(r,this.liquid,s),this.currentFile=e.file;const n=r.p;"with"===r.readIdentifier().content?(r.skipBlank(),":"!==r.peek()?this.withVar=r.readValue():r.p=n):r.p=n,this.hash=new Hash(r,i.options.jekyllInclude||i.options.keyValueSeparator)}*render(e,t){const{liquid:i,hash:s,withVar:r}=this,{renderer:n}=i,o=yield renderFilePath(this.file,e,i);assert(o,(()=>`illegal file path "${o}"`));const a=e.saveRegister("blocks","blockMode");e.setRegister("blocks",{}),e.setRegister("blockMode",BlockMode.OUTPUT);const l=yield s.render(e);r&&(l[o]=yield evalToken(r,e));const c=yield i._parsePartialFile(o,e.sync,this.currentFile);e.push(e.opts.jekyllInclude?{include:l}:l),yield n.renderTemplates(c,e,t),e.pop(),e.restoreRegister(a)}*children(e,t){return e&&isString(this.file)?yield this.liquid._parsePartialFile(this.file,t,this.currentFile):[]}partialScope(){if(isString(this.file)){let e;return this.liquid.options.jekyllInclude?e=["include"]:(e=Object.keys(this.hash.hash),this.withVar&&e.push([this.file,this.withVar])),{name:this.file,isolated:!1,scope:e}}}*arguments(){yield*Object.values(this.hash.hash).filter(isValueToken),isValueToken(this.file)&&(yield this.file),isValueToken(this.withVar)&&(yield this.withVar)}}class DecrementTag extends Tag{constructor(e,t,i){super(e,t,i),this.identifier=this.tokenizer.readIdentifier(),this.variable=this.identifier.content}render(e,t){const i=e.environments;isNumber(i[this.variable])||(i[this.variable]=0),t.write(stringify(--i[this.variable]))}*localScope(){yield this.identifier}}class CycleTag extends Tag{constructor(e,t,i){super(e,t,i),this.candidates=[];const s=this.tokenizer.readValue();for(this.tokenizer.skipBlank(),s&&(":"===this.tokenizer.peek()?(this.group=s,this.tokenizer.advance()):this.candidates.push(s));!this.tokenizer.end();){const e=this.tokenizer.readValue();e&&this.candidates.push(e),this.tokenizer.readTo(",")}this.tokenizer.assert(this.candidates.length,(()=>`empty candidates: "${e.getText()}"`))}*render(e,t){const i=`cycle:${yield evalToken(this.group,e)}:`+this.candidates.join(","),s=e.getRegister("cycle");let r=s[i];void 0===r&&(r=s[i]=0);const n=this.candidates[r];return r=(r+1)%this.candidates.length,s[i]=r,yield evalToken(n,e)}*arguments(){yield*this.candidates,this.group&&(yield this.group)}}class IfTag extends Tag{constructor(e,t,i,s){super(e,t,i),this.branches=[];let r=[];s.parseStream(t).on("start",(()=>this.branches.push({value:new Value(e.tokenizer.readFilteredValue(),this.liquid),templates:r=[]}))).on("tag:elsif",(e=>{assert(!this.elseTemplates,"unexpected elsif after else"),this.branches.push({value:new Value(e.tokenizer.readFilteredValue(),this.liquid),templates:r=[]})})).on("tag:else",(e=>{assertEmpty(e.args),assert(!this.elseTemplates,"duplicated else"),r=this.elseTemplates=[]})).on("tag:endif",(function(e){assertEmpty(e.args),this.stop()})).on("template",(e=>r.push(e))).on("end",(()=>{throw new Error(`tag ${e.getText()} not closed`)})).start()}*render(e,t){const i=this.liquid.renderer;for(const{value:s,templates:r}of this.branches){if(isTruthy(yield s.value(e,e.opts.lenientIf),e))return void(yield i.renderTemplates(r,e,t))}yield i.renderTemplates(this.elseTemplates||[],e,t)}*children(){const e=this.branches.flatMap((e=>e.templates));return this.elseTemplates&&e.push(...this.elseTemplates),e}arguments(){return this.branches.map((e=>e.value))}}class IncrementTag extends Tag{constructor(e,t,i){super(e,t,i),this.identifier=this.tokenizer.readIdentifier(),this.variable=this.identifier.content}render(e,t){const i=e.environments;isNumber(i[this.variable])||(i[this.variable]=0);const s=i[this.variable];i[this.variable]++,t.write(stringify(s))}*localScope(){yield this.identifier}}class LayoutTag extends Tag{constructor(e,t,i,s){super(e,t,i),this.file=parseFilePath(this.tokenizer,this.liquid,s),this.currentFile=e.file,this.args=new Hash(this.tokenizer,i.options.keyValueSeparator),this.templates=s.parseTokens(t)}*render(e,t){const{liquid:i,args:s,file:r}=this,{renderer:n}=i;if(void 0===r)return e.setRegister("blockMode",BlockMode.OUTPUT),void(yield n.renderTemplates(this.templates,e,t));const o=yield renderFilePath(this.file,e,i);assert(o,(()=>`illegal file path "${o}"`));const a=yield i._parseLayoutFile(o,e.sync,this.currentFile);e.setRegister("blockMode",BlockMode.STORE);const l=yield n.renderTemplates(this.templates,e),c=e.getRegister("blocks");void 0===c[""]&&(c[""]=(e,t)=>t.write(l)),e.setRegister("blockMode",BlockMode.OUTPUT),e.push(yield s.render(e)),yield n.renderTemplates(a,e,t),e.pop()}*children(e){const t=this.templates.slice();return e&&isString(this.file)&&t.push(...yield this.liquid._parsePartialFile(this.file,!0,this.currentFile)),t}*arguments(){for(const e of Object.values(this.args.hash))isValueToken(e)&&(yield e);isValueToken(this.file)&&(yield this.file)}partialScope(){if(isString(this.file))return{name:this.file,isolated:!1,scope:Object.keys(this.args.hash)}}}class BlockTag extends Tag{constructor(e,t,i,s){super(e,t,i),this.templates=[];const r=/\w+/.exec(e.args);for(this.block=r?r[0]:"";t.length;){const e=t.shift();if(isTagToken(e)&&"endblock"===e.name)return;const i=s.parseToken(e,t);this.templates.push(i)}throw new Error(`tag ${e.getText()} not closed`)}*render(e,t){const i=this.getBlockRender(e);e.getRegister("blockMode")===BlockMode.STORE?e.getRegister("blocks")[this.block]=i:yield i(new BlockDrop,t)}getBlockRender(e){const{liquid:t,templates:i}=this,s=e.getRegister("blocks")[this.block],r=function*(s,r){e.push({block:s}),yield t.renderer.renderTemplates(i,e,r),e.pop()};return s?(e,t)=>s(new BlockDrop((()=>r(e,t))),t):r}*children(){return this.templates}blockScope(){return["block"]}}class RawTag extends Tag{constructor(e,t,i){for(super(e,t,i),this.tokens=[];t.length;){const e=t.shift();if(isTagToken(e)&&"endraw"===e.name)return;this.tokens.push(e)}throw new Error(`tag ${e.getText()} not closed`)}render(){return this.tokens.map((e=>e.getText())).join("")}}class TablerowloopDrop extends ForloopDrop{constructor(e,t,i,s){super(e,i,s),this.length=e,this.cols=t}row(){return Math.floor(this.i/this.cols)+1}col0(){return this.i%this.cols}col(){return this.col0()+1}col_first(){return 0===this.col0()}col_last(){return this.col()===this.cols}}class TablerowTag extends Tag{constructor(e,t,i,s){super(e,t,i);const r=this.tokenizer.readIdentifier();this.tokenizer.skipBlank();const n=this.tokenizer.readIdentifier(),o=this.tokenizer.readValue();if("in"!==n.content||!o)throw new Error(`illegal tag: ${e.getText()}`);let a;this.variable=r.content,this.collection=o,this.args=new Hash(this.tokenizer,i.options.keyValueSeparator),this.templates=[];const l=s.parseStream(t).on("start",(()=>a=this.templates)).on("tag:endtablerow",(()=>l.stop())).on("template",(e=>a.push(e))).on("end",(()=>{throw new Error(`tag ${e.getText()} not closed`)}));l.start()}*render(e,t){let i=toEnumerable(yield evalToken(this.collection,e));const s=yield this.args.render(e),r=s.offset||0,n=void 0===s.limit?i.length:s.limit;i=i.slice(r,r+n);const o=s.cols||i.length,a=this.liquid.renderer,l=new TablerowloopDrop(i.length,o,this.collection.getText(),this.variable),c={tablerowloop:l};e.push(c);for(let s=0;s<i.length;s++,l.next())c[this.variable]=i[s],0===l.col0()&&(1!==l.row()&&t.write("</tr>"),t.write(`<tr class="row${l.row()}">`)),t.write(`<td class="col${l.col()}">`),yield a.renderTemplates(this.templates,e,t),t.write("</td>");i.length&&t.write("</tr>"),e.pop()}*children(){return this.templates}*arguments(){yield this.collection;for(const e of Object.values(this.args.hash))isValueToken(e)&&(yield e)}blockScope(){return[this.variable,"tablerowloop"]}}class UnlessTag extends Tag{constructor(e,t,i,s){super(e,t,i),this.branches=[],this.elseTemplates=[];let r=[],n=0;s.parseStream(t).on("start",(()=>this.branches.push({value:new Value(e.tokenizer.readFilteredValue(),this.liquid),test:isFalsy,templates:r=[]}))).on("tag:elsif",(e=>{n>0?r=[]:this.branches.push({value:new Value(e.tokenizer.readFilteredValue(),this.liquid),test:isTruthy,templates:r=[]})})).on("tag:else",(()=>{n++,r=this.elseTemplates})).on("tag:endunless",(function(){this.stop()})).on("template",(e=>{r===this.elseTemplates&&1!==n||r.push(e)})).on("end",(()=>{throw new Error(`tag ${e.getText()} not closed`)})).start()}*render(e,t){const i=this.liquid.renderer;for(const{value:s,test:r,templates:n}of this.branches){if(r(yield s.value(e,e.opts.lenientIf),e))return void(yield i.renderTemplates(n,e,t))}yield i.renderTemplates(this.elseTemplates,e,t)}*children(){const e=this.branches.flatMap((e=>e.templates));return this.elseTemplates&&e.push(...this.elseTemplates),e}arguments(){return this.branches.map((e=>e.value))}}class BreakTag extends Tag{render(e,t){e.breakCalled=!0}}class ContinueTag extends Tag{render(e,t){e.continueCalled=!0}}class EchoTag extends Tag{constructor(e,t,i){super(e,t,i),this.tokenizer.skipBlank(),this.tokenizer.end()||(this.value=new Value(this.tokenizer.readFilteredValue(),this.liquid))}*render(e,t){if(!this.value)return;const i=yield this.value.value(e,!1);t.write(i)}*arguments(){this.value&&(yield this.value)}}class LiquidTag extends Tag{constructor(e,t,i,s){super(e,t,i);const r=this.tokenizer.readLiquidTagTokens(this.liquid.options);this.templates=s.parseTokens(r)}*render(e,t){yield this.liquid.renderer.renderTemplates(this.templates,e,t)}*children(){return this.templates}}class InlineCommentTag extends Tag{constructor(e,t,i){if(super(e,t,i),-1!==e.args.search(/\n\s*[^#\s]/g))throw new Error("every line of an inline comment must start with a '#' character")}render(){}}const tags={assign:AssignTag,for:ForTag,capture:CaptureTag,case:CaseTag,comment:CommentTag,include:IncludeTag,render:RenderTag,decrement:DecrementTag,increment:IncrementTag,cycle:CycleTag,if:IfTag,layout:LayoutTag,block:BlockTag,raw:RawTag,tablerow:TablerowTag,unless:UnlessTag,break:BreakTag,continue:ContinueTag,echo:EchoTag,liquid:LiquidTag,"#":InlineCommentTag};class Liquid{constructor(e={}){this.renderer=new Render,this.filters={},this.tags={},this.options=normalize(e),this.parser=new Parser(this),forOwn(tags,((e,t)=>this.registerTag(t,e))),forOwn(filters,((e,t)=>this.registerFilter(t,e)))}parse(e,t){return new Parser(this).parse(e,t)}_render(e,t,i){const s=t instanceof Context?t:new Context(t,this.options,i);return this.renderer.renderTemplates(e,s)}render(e,t,i){return __awaiter(this,void 0,void 0,(function*(){return toPromise(this._render(e,t,Object.assign(Object.assign({},i),{sync:!1})))}))}renderSync(e,t,i){return toValueSync(this._render(e,t,Object.assign(Object.assign({},i),{sync:!0})))}renderToNodeStream(e,t,i={}){const s=new Context(t,this.options,i);return this.renderer.renderTemplatesToNodeStream(e,s)}_parseAndRender(e,t,i){const s=this.parse(e);return this._render(s,t,i)}parseAndRender(e,t,i){return __awaiter(this,void 0,void 0,(function*(){return toPromise(this._parseAndRender(e,t,Object.assign(Object.assign({},i),{sync:!1})))}))}parseAndRenderSync(e,t,i){return toValueSync(this._parseAndRender(e,t,Object.assign(Object.assign({},i),{sync:!0})))}_parsePartialFile(e,t,i){return new Parser(this).parseFile(e,t,LookupType.Partials,i)}_parseLayoutFile(e,t,i){return new Parser(this).parseFile(e,t,LookupType.Layouts,i)}_parseFile(e,t,i,s){return new Parser(this).parseFile(e,t,i,s)}parseFile(e,t){return __awaiter(this,void 0,void 0,(function*(){return toPromise(new Parser(this).parseFile(e,!1,t))}))}parseFileSync(e,t){return toValueSync(new Parser(this).parseFile(e,!0,t))}*_renderFile(e,t,i){const s=yield this._parseFile(e,i.sync,i.lookupType);return yield this._render(s,t,i)}renderFile(e,t,i){return __awaiter(this,void 0,void 0,(function*(){return toPromise(this._renderFile(e,t,Object.assign(Object.assign({},i),{sync:!1})))}))}renderFileSync(e,t,i){return toValueSync(this._renderFile(e,t,Object.assign(Object.assign({},i),{sync:!0})))}renderFileToNodeStream(e,t,i){return __awaiter(this,void 0,void 0,(function*(){const s=yield this.parseFile(e);return this.renderToNodeStream(s,t,i)}))}_evalValue(e,t){const i=new Value(e,this),s=t instanceof Context?t:new Context(t,this.options);return i.value(s)}evalValue(e,t){return __awaiter(this,void 0,void 0,(function*(){return toPromise(this._evalValue(e,t))}))}evalValueSync(e,t){return toValueSync(this._evalValue(e,t))}registerFilter(e,t){this.filters[e]=t}registerTag(e,t){this.tags[e]=isFunction(t)?t:createTagClass(t)}plugin(e){return e.call(this,Liquid)}express(){const e=this;let t=!0;return function(i,s,r){if(t){t=!1;const i=normalizeDirectoryList(this.root);e.options.root.unshift(...i),e.options.layouts.unshift(...i),e.options.partials.unshift(...i)}e.renderFile(i,s).then((e=>r(null,e)),r)}}analyze(e,t={}){return __awaiter(this,void 0,void 0,(function*(){return analyze(e,t)}))}analyzeSync(e,t={}){return analyzeSync(e,t)}parseAndAnalyze(e,t,i={}){return __awaiter(this,void 0,void 0,(function*(){return analyze(this.parse(e,t),i)}))}parseAndAnalyzeSync(e,t,i={}){return analyzeSync(this.parse(e,t),i)}variables(e,t={}){return __awaiter(this,void 0,void 0,(function*(){const i=yield analyze(isString(e)?this.parse(e):e,t);return Object.keys(i.variables)}))}variablesSync(e,t={}){const i=analyzeSync(isString(e)?this.parse(e):e,t);return Object.keys(i.variables)}fullVariables(e,t={}){return __awaiter(this,void 0,void 0,(function*(){const i=yield analyze(isString(e)?this.parse(e):e,t);return Array.from(new Set(Object.values(i.variables).flatMap((e=>e.map((e=>String(e)))))))}))}fullVariablesSync(e,t={}){const i=analyzeSync(isString(e)?this.parse(e):e,t);return Array.from(new Set(Object.values(i.variables).flatMap((e=>e.map((e=>String(e)))))))}variableSegments(e,t={}){return __awaiter(this,void 0,void 0,(function*(){const i=yield analyze(isString(e)?this.parse(e):e,t);return Array.from(strictUniq(Object.values(i.variables).flatMap((e=>e.map((e=>e.toArray()))))))}))}variableSegmentsSync(e,t={}){const i=analyzeSync(isString(e)?this.parse(e):e,t);return Array.from(strictUniq(Object.values(i.variables).flatMap((e=>e.map((e=>e.toArray()))))))}globalVariables(e,t={}){return __awaiter(this,void 0,void 0,(function*(){const i=yield analyze(isString(e)?this.parse(e):e,t);return Object.keys(i.globals)}))}globalVariablesSync(e,t={}){const i=analyzeSync(isString(e)?this.parse(e):e,t);return Object.keys(i.globals)}globalFullVariables(e,t={}){return __awaiter(this,void 0,void 0,(function*(){const i=yield analyze(isString(e)?this.parse(e):e,t);return Array.from(new Set(Object.values(i.globals).flatMap((e=>e.map((e=>String(e)))))))}))}globalFullVariablesSync(e,t={}){const i=analyzeSync(isString(e)?this.parse(e):e,t);return Array.from(new Set(Object.values(i.globals).flatMap((e=>e.map((e=>String(e)))))))}globalVariableSegments(e,t={}){return __awaiter(this,void 0,void 0,(function*(){const i=yield analyze(isString(e)?this.parse(e):e,t);return Array.from(strictUniq(Object.values(i.globals).flatMap((e=>e.map((e=>e.toArray()))))))}))}globalVariableSegmentsSync(e,t={}){const i=analyzeSync(isString(e)?this.parse(e):e,t);return Array.from(strictUniq(Object.values(i.globals).flatMap((e=>e.map((e=>e.toArray()))))))}}const version="[VI]{version}[/VI]";export{AssertionError,AssignTag,BlockTag,BreakTag,CaptureTag,CaseTag,CommentTag,Context,ContinueTag,CycleTag,DecrementTag,Drop,EchoTag,Expression,Filter,ForTag,Hash,IfTag,IncludeTag,IncrementTag,InlineCommentTag,LayoutTag,Liquid,LiquidError,LiquidTag,Output,ParseError,ParseStream,Parser,RawTag,RenderError,RenderTag,TablerowTag,Tag,TagToken,Token,TokenKind,TokenizationError,Tokenizer,typeGuards as TypeGuards,UndefinedVariableError,UnlessTag,Value,Variable,analyze,analyzeSync,assert,createTrie,defaultOperators,defaultOptions,evalQuotedToken,evalToken,filters,isFalsy,isTruthy,tags,toPromise,toValue,toValueSync,version};
//# sourceMappingURL=/sm/67a5d437f590301b916b6a52c45cabb4af5debd301e5e605f6c933ea73aad859.map